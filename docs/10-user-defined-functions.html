<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 User Defined Functions | STA 444/5 - Introductory Data Science using R</title>
  <meta name="description" content="Chapter 10 User Defined Functions | STA 444/5 - Introductory Data Science using R" />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 User Defined Functions | STA 444/5 - Introductory Data Science using R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/Cover1.png" />
  
  <meta name="github-repo" content="dereksonderegger/444" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 User Defined Functions | STA 444/5 - Introductory Data Science using R" />
  
  
  <meta name="twitter:image" content="images/Cover1.png" />

<meta name="author" content="Derek L. Sonderegger" />


<meta name="date" content="2019-10-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="9-importing-data.html">
<link rel="next" href="11-string-manipulation.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-resources"><i class="fa fa-check"></i>Other Resources</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="part"><span><b>Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="1-familiarization.html"><a href="1-familiarization.html"><i class="fa fa-check"></i><b>1</b> Familiarization</a><ul>
<li class="chapter" data-level="1.1" data-path="1-familiarization.html"><a href="1-familiarization.html#r-file-types"><i class="fa fa-check"></i><b>1.1</b> R file Types</a><ul>
<li class="chapter" data-level="1.1.1" data-path="1-familiarization.html"><a href="1-familiarization.html#r-scripts-.r-files"><i class="fa fa-check"></i><b>1.1.1</b> R Scripts (.R files)</a></li>
<li class="chapter" data-level="1.1.2" data-path="1-familiarization.html"><a href="1-familiarization.html#r-markdown-.rmd-files"><i class="fa fa-check"></i><b>1.1.2</b> R Markdown (.Rmd files)</a></li>
<li class="chapter" data-level="1.1.3" data-path="1-familiarization.html"><a href="1-familiarization.html#r-notebooks-.rmd-files"><i class="fa fa-check"></i><b>1.1.3</b> R Notebooks (.Rmd files)</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="1-familiarization.html"><a href="1-familiarization.html#r-as-a-simple-calculator"><i class="fa fa-check"></i><b>1.2</b> R as a simple calculator</a></li>
<li class="chapter" data-level="1.3" data-path="1-familiarization.html"><a href="1-familiarization.html#assignment"><i class="fa fa-check"></i><b>1.3</b> Assignment</a></li>
<li class="chapter" data-level="1.4" data-path="1-familiarization.html"><a href="1-familiarization.html#vectors"><i class="fa fa-check"></i><b>1.4</b> Vectors</a></li>
<li class="chapter" data-level="1.5" data-path="1-familiarization.html"><a href="1-familiarization.html#packages"><i class="fa fa-check"></i><b>1.5</b> Packages</a></li>
<li class="chapter" data-level="1.6" data-path="1-familiarization.html"><a href="1-familiarization.html#finding-help"><i class="fa fa-check"></i><b>1.6</b> Finding Help</a><ul>
<li class="chapter" data-level="1.6.1" data-path="1-familiarization.html"><a href="1-familiarization.html#how-does-this-function-work"><i class="fa fa-check"></i><b>1.6.1</b> How does this function work?</a></li>
<li class="chapter" data-level="1.6.2" data-path="1-familiarization.html"><a href="1-familiarization.html#how-does-this-package-work"><i class="fa fa-check"></i><b>1.6.2</b> How does this package work?</a></li>
<li class="chapter" data-level="1.6.3" data-path="1-familiarization.html"><a href="1-familiarization.html#how-do-i-do-xxx"><i class="fa fa-check"></i><b>1.6.3</b> How do I do XXX?</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="1-familiarization.html"><a href="1-familiarization.html#exercises"><i class="fa fa-check"></i><b>1.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-data-frames.html"><a href="2-data-frames.html"><i class="fa fa-check"></i><b>2</b> Data Frames</a><ul>
<li class="chapter" data-level="2.1" data-path="2-data-frames.html"><a href="2-data-frames.html#introduction-to-importing-data"><i class="fa fa-check"></i><b>2.1</b> Introduction to Importing Data</a><ul>
<li class="chapter" data-level="2.1.1" data-path="2-data-frames.html"><a href="2-data-frames.html#from-a-package"><i class="fa fa-check"></i><b>2.1.1</b> From a Package</a></li>
<li class="chapter" data-level="2.1.2" data-path="2-data-frames.html"><a href="2-data-frames.html#import-from-.csv-or-.xls-files"><i class="fa fa-check"></i><b>2.1.2</b> Import from <code>.csv</code> or <code>.xls</code> files</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-data-frames.html"><a href="2-data-frames.html#data-types"><i class="fa fa-check"></i><b>2.2</b> Data Types</a></li>
<li class="chapter" data-level="2.3" data-path="2-data-frames.html"><a href="2-data-frames.html#basic-manipulation"><i class="fa fa-check"></i><b>2.3</b> Basic Manipulation</a></li>
<li class="chapter" data-level="2.4" data-path="2-data-frames.html"><a href="2-data-frames.html#exercises-1"><i class="fa fa-check"></i><b>2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-graphing.html"><a href="3-graphing.html"><i class="fa fa-check"></i><b>3</b> Graphing</a><ul>
<li class="chapter" data-level="3.1" data-path="3-graphing.html"><a href="3-graphing.html#basic-graphs"><i class="fa fa-check"></i><b>3.1</b> Basic Graphs</a><ul>
<li class="chapter" data-level="3.1.1" data-path="3-graphing.html"><a href="3-graphing.html#scatterplots"><i class="fa fa-check"></i><b>3.1.1</b> Scatterplots</a></li>
<li class="chapter" data-level="3.1.2" data-path="3-graphing.html"><a href="3-graphing.html#box-plots"><i class="fa fa-check"></i><b>3.1.2</b> Box Plots</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="3-graphing.html"><a href="3-graphing.html#title-axis-labels"><i class="fa fa-check"></i><b>3.2</b> Title &amp; Axis Labels</a></li>
<li class="chapter" data-level="3.3" data-path="3-graphing.html"><a href="3-graphing.html#annotation"><i class="fa fa-check"></i><b>3.3</b> Annotation</a><ul>
<li class="chapter" data-level="3.3.1" data-path="3-graphing.html"><a href="3-graphing.html#using-a-data.frame"><i class="fa fa-check"></i><b>3.3.1</b> Using a <code>data.frame</code></a></li>
<li class="chapter" data-level="3.3.2" data-path="3-graphing.html"><a href="3-graphing.html#setting-attributes-in-line"><i class="fa fa-check"></i><b>3.3.2</b> Setting attributes in-line</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="3-graphing.html"><a href="3-graphing.html#faceting"><i class="fa fa-check"></i><b>3.4</b> Faceting</a></li>
<li class="chapter" data-level="3.5" data-path="3-graphing.html"><a href="3-graphing.html#exercises-2"><i class="fa fa-check"></i><b>3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-data-wrangling.html"><a href="4-data-wrangling.html"><i class="fa fa-check"></i><b>4</b> Data Wrangling</a><ul>
<li class="chapter" data-level="4.1" data-path="4-data-wrangling.html"><a href="4-data-wrangling.html#verbs"><i class="fa fa-check"></i><b>4.1</b> Verbs</a><ul>
<li class="chapter" data-level="4.1.1" data-path="4-data-wrangling.html"><a href="4-data-wrangling.html#add_row"><i class="fa fa-check"></i><b>4.1.1</b> <code>add_row</code></a></li>
<li class="chapter" data-level="4.1.2" data-path="4-data-wrangling.html"><a href="4-data-wrangling.html#subsetting"><i class="fa fa-check"></i><b>4.1.2</b> Subsetting</a></li>
<li class="chapter" data-level="4.1.3" data-path="4-data-wrangling.html"><a href="4-data-wrangling.html#arrange"><i class="fa fa-check"></i><b>4.1.3</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="4.1.4" data-path="4-data-wrangling.html"><a href="4-data-wrangling.html#mutate"><i class="fa fa-check"></i><b>4.1.4</b> mutate()</a></li>
<li class="chapter" data-level="4.1.5" data-path="4-data-wrangling.html"><a href="4-data-wrangling.html#summarise"><i class="fa fa-check"></i><b>4.1.5</b> summarise()</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="4-data-wrangling.html"><a href="4-data-wrangling.html#split-apply-combine"><i class="fa fa-check"></i><b>4.2</b> Split, apply, combine</a></li>
<li class="chapter" data-level="4.3" data-path="4-data-wrangling.html"><a href="4-data-wrangling.html#exercises-3"><i class="fa fa-check"></i><b>4.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-statistical-models.html"><a href="5-statistical-models.html"><i class="fa fa-check"></i><b>5</b> Statistical Models</a><ul>
<li class="chapter" data-level="5.1" data-path="5-statistical-models.html"><a href="5-statistical-models.html#formula-notation"><i class="fa fa-check"></i><b>5.1</b> Formula Notation</a></li>
<li class="chapter" data-level="5.2" data-path="5-statistical-models.html"><a href="5-statistical-models.html#basic-models"><i class="fa fa-check"></i><b>5.2</b> Basic Models</a><ul>
<li class="chapter" data-level="5.2.1" data-path="5-statistical-models.html"><a href="5-statistical-models.html#t-tests"><i class="fa fa-check"></i><b>5.2.1</b> t-tests</a></li>
<li class="chapter" data-level="5.2.2" data-path="5-statistical-models.html"><a href="5-statistical-models.html#lm-objects"><i class="fa fa-check"></i><b>5.2.2</b> lm objects</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="5-statistical-models.html"><a href="5-statistical-models.html#accessor-function"><i class="fa fa-check"></i><b>5.3</b> Accessor function</a></li>
<li class="chapter" data-level="5.4" data-path="5-statistical-models.html"><a href="5-statistical-models.html#exercises-4"><i class="fa fa-check"></i><b>5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-flow-control.html"><a href="6-flow-control.html"><i class="fa fa-check"></i><b>6</b> Flow Control</a><ul>
<li class="chapter" data-level="6.1" data-path="6-flow-control.html"><a href="6-flow-control.html#logical-expressions"><i class="fa fa-check"></i><b>6.1</b> Logical Expressions</a></li>
<li class="chapter" data-level="6.2" data-path="6-flow-control.html"><a href="6-flow-control.html#decision-statements"><i class="fa fa-check"></i><b>6.2</b> Decision statements</a><ul>
<li class="chapter" data-level="6.2.1" data-path="6-flow-control.html"><a href="6-flow-control.html#in-dplyr-wrangling"><i class="fa fa-check"></i><b>6.2.1</b> In <code>dplyr</code> wrangling</a></li>
<li class="chapter" data-level="6.2.2" data-path="6-flow-control.html"><a href="6-flow-control.html#general-if-else"><i class="fa fa-check"></i><b>6.2.2</b> General <code>if else</code></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="6-flow-control.html"><a href="6-flow-control.html#loops"><i class="fa fa-check"></i><b>6.3</b> Loops</a><ul>
<li class="chapter" data-level="6.3.1" data-path="6-flow-control.html"><a href="6-flow-control.html#while-loops"><i class="fa fa-check"></i><b>6.3.1</b> <code>while</code> Loops</a></li>
<li class="chapter" data-level="6.3.2" data-path="6-flow-control.html"><a href="6-flow-control.html#for-loops"><i class="fa fa-check"></i><b>6.3.2</b> <code>for</code> Loops</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="6-flow-control.html"><a href="6-flow-control.html#exercises-5"><i class="fa fa-check"></i><b>6.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-factors.html"><a href="7-factors.html"><i class="fa fa-check"></i><b>7</b> Factors</a><ul>
<li class="chapter" data-level="7.1" data-path="7-factors.html"><a href="7-factors.html#creation-and-structure"><i class="fa fa-check"></i><b>7.1</b> Creation and Structure</a></li>
<li class="chapter" data-level="7.2" data-path="7-factors.html"><a href="7-factors.html#change-labels"><i class="fa fa-check"></i><b>7.2</b> Change Labels</a></li>
<li class="chapter" data-level="7.3" data-path="7-factors.html"><a href="7-factors.html#reorder-levels-1"><i class="fa fa-check"></i><b>7.3</b> Reorder Levels</a></li>
<li class="chapter" data-level="7.4" data-path="7-factors.html"><a href="7-factors.html#add-or-substract-levels"><i class="fa fa-check"></i><b>7.4</b> Add or substract Levels</a></li>
<li class="chapter" data-level="7.5" data-path="7-factors.html"><a href="7-factors.html#exercises-6"><i class="fa fa-check"></i><b>7.5</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>Miscellaneous</b></span></li>
<li class="chapter" data-level="" data-path="statistical-tables.html"><a href="statistical-tables.html"><i class="fa fa-check"></i>Statistical Tables</a><ul>
<li class="chapter" data-level="" data-path="statistical-tables.html"><a href="statistical-tables.html#example-distributions"><i class="fa fa-check"></i>Example Distributions</a></li>
<li><a href="statistical-tables.html#mosaicplotdist-function"><code>mosaic::plotDist()</code> function</a></li>
<li class="chapter" data-level="" data-path="statistical-tables.html"><a href="statistical-tables.html#base-r-functions"><i class="fa fa-check"></i>Base R functions</a><ul>
<li class="chapter" data-level="" data-path="statistical-tables.html"><a href="statistical-tables.html#d-function"><i class="fa fa-check"></i>d-function</a></li>
<li class="chapter" data-level="" data-path="statistical-tables.html"><a href="statistical-tables.html#p-function"><i class="fa fa-check"></i>p-function</a></li>
<li><a href="statistical-tables.html#q-function"><code>q</code>-function</a></li>
<li class="chapter" data-level="" data-path="statistical-tables.html"><a href="statistical-tables.html#r-function"><i class="fa fa-check"></i>r-function</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="statistical-tables.html"><a href="statistical-tables.html#exercises-7"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rmarkdown-tricks.html"><a href="rmarkdown-tricks.html"><i class="fa fa-check"></i>Rmarkdown Tricks</a><ul>
<li class="chapter" data-level="" data-path="rmarkdown-tricks.html"><a href="rmarkdown-tricks.html#chunk-options"><i class="fa fa-check"></i>Chunk Options</a></li>
<li class="chapter" data-level="" data-path="rmarkdown-tricks.html"><a href="rmarkdown-tricks.html#verbatim-list-environments"><i class="fa fa-check"></i>Verbatim &amp; List Environments</a></li>
<li class="chapter" data-level="" data-path="rmarkdown-tricks.html"><a href="rmarkdown-tricks.html#mathematical-expressions"><i class="fa fa-check"></i>Mathematical expressions</a></li>
<li class="chapter" data-level="" data-path="rmarkdown-tricks.html"><a href="rmarkdown-tricks.html#tables"><i class="fa fa-check"></i>Tables</a><ul>
<li class="chapter" data-level="7.5.1" data-path="rmarkdown-tricks.html"><a href="rmarkdown-tricks.html#simple-tables"><i class="fa fa-check"></i><b>7.5.1</b> Simple Tables</a></li>
<li class="chapter" data-level="7.5.2" data-path="rmarkdown-tricks.html"><a href="rmarkdown-tricks.html#grid-tables"><i class="fa fa-check"></i><b>7.5.2</b> Grid Tables</a></li>
<li class="chapter" data-level="7.5.3" data-path="rmarkdown-tricks.html"><a href="rmarkdown-tricks.html#pipe-tables"><i class="fa fa-check"></i><b>7.5.3</b> Pipe Tables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rmarkdown-tricks.html"><a href="rmarkdown-tricks.html#r-functions-to-produce-table-code."><i class="fa fa-check"></i>R functions to produce table code.</a><ul>
<li class="chapter" data-level="7.5.4" data-path="rmarkdown-tricks.html"><a href="rmarkdown-tricks.html#knitrkable"><i class="fa fa-check"></i><b>7.5.4</b> <code class="unnumbered">knitr::kable</code></a></li>
<li class="chapter" data-level="7.5.5" data-path="rmarkdown-tricks.html"><a href="rmarkdown-tricks.html#package-pander"><i class="fa fa-check"></i><b>7.5.5</b> Package <code class="unnumbered">pander</code></a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Deeper Details</b></span></li>
<li class="chapter" data-level="8" data-path="8-data-structures.html"><a href="8-data-structures.html"><i class="fa fa-check"></i><b>8</b> Data Structures</a><ul>
<li class="chapter" data-level="8.1" data-path="8-data-structures.html"><a href="8-data-structures.html#vectors-1"><i class="fa fa-check"></i><b>8.1</b> Vectors</a><ul>
<li class="chapter" data-level="8.1.1" data-path="8-data-structures.html"><a href="8-data-structures.html#accessing-vector-elements"><i class="fa fa-check"></i><b>8.1.1</b> Accessing Vector Elements</a></li>
<li class="chapter" data-level="8.1.2" data-path="8-data-structures.html"><a href="8-data-structures.html#scalar-functions-applied-to-vectors"><i class="fa fa-check"></i><b>8.1.2</b> Scalar Functions Applied to Vectors</a></li>
<li class="chapter" data-level="8.1.3" data-path="8-data-structures.html"><a href="8-data-structures.html#vector-algebra"><i class="fa fa-check"></i><b>8.1.3</b> Vector Algebra</a></li>
<li class="chapter" data-level="8.1.4" data-path="8-data-structures.html"><a href="8-data-structures.html#commonly-used-vector-functions"><i class="fa fa-check"></i><b>8.1.4</b> Commonly Used Vector Functions</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="8-data-structures.html"><a href="8-data-structures.html#matrices"><i class="fa fa-check"></i><b>8.2</b> Matrices</a></li>
<li class="chapter" data-level="8.3" data-path="8-data-structures.html"><a href="8-data-structures.html#data-frames-1"><i class="fa fa-check"></i><b>8.3</b> Data Frames</a></li>
<li class="chapter" data-level="8.4" data-path="8-data-structures.html"><a href="8-data-structures.html#lists"><i class="fa fa-check"></i><b>8.4</b> Lists</a></li>
<li class="chapter" data-level="8.5" data-path="8-data-structures.html"><a href="8-data-structures.html#exercises-8"><i class="fa fa-check"></i><b>8.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-importing-data.html"><a href="9-importing-data.html"><i class="fa fa-check"></i><b>9</b> Importing Data</a><ul>
<li class="chapter" data-level="9.1" data-path="9-importing-data.html"><a href="9-importing-data.html#working-directory"><i class="fa fa-check"></i><b>9.1</b> Working directory</a></li>
<li class="chapter" data-level="9.2" data-path="9-importing-data.html"><a href="9-importing-data.html#comma-separated-data"><i class="fa fa-check"></i><b>9.2</b> Comma Separated Data</a></li>
<li class="chapter" data-level="9.3" data-path="9-importing-data.html"><a href="9-importing-data.html#ms-excel"><i class="fa fa-check"></i><b>9.3</b> MS Excel</a></li>
<li class="chapter" data-level="9.4" data-path="9-importing-data.html"><a href="9-importing-data.html#exercises-9"><i class="fa fa-check"></i><b>9.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-user-defined-functions.html"><a href="10-user-defined-functions.html"><i class="fa fa-check"></i><b>10</b> User Defined Functions</a><ul>
<li class="chapter" data-level="10.1" data-path="10-user-defined-functions.html"><a href="10-user-defined-functions.html#basic-function-definition"><i class="fa fa-check"></i><b>10.1</b> Basic function definition</a></li>
<li class="chapter" data-level="10.2" data-path="10-user-defined-functions.html"><a href="10-user-defined-functions.html#parameter-defaults"><i class="fa fa-check"></i><b>10.2</b> Parameter Defaults</a></li>
<li class="chapter" data-level="10.3" data-path="10-user-defined-functions.html"><a href="10-user-defined-functions.html#ellipses"><i class="fa fa-check"></i><b>10.3</b> Ellipses</a></li>
<li class="chapter" data-level="10.4" data-path="10-user-defined-functions.html"><a href="10-user-defined-functions.html#function-overloading"><i class="fa fa-check"></i><b>10.4</b> Function Overloading</a></li>
<li class="chapter" data-level="10.5" data-path="10-user-defined-functions.html"><a href="10-user-defined-functions.html#debugging"><i class="fa fa-check"></i><b>10.5</b> Debugging</a><ul>
<li class="chapter" data-level="10.5.1" data-path="10-user-defined-functions.html"><a href="10-user-defined-functions.html#rmarkdown-recommendations"><i class="fa fa-check"></i><b>10.5.1</b> Rmarkdown Recommendations</a></li>
<li class="chapter" data-level="10.5.2" data-path="10-user-defined-functions.html"><a href="10-user-defined-functions.html#step-wise-execution"><i class="fa fa-check"></i><b>10.5.2</b> Step-wise Execution</a></li>
<li class="chapter" data-level="10.5.3" data-path="10-user-defined-functions.html"><a href="10-user-defined-functions.html#print-statements"><i class="fa fa-check"></i><b>10.5.3</b> Print Statements</a></li>
<li class="chapter" data-level="10.5.4" data-path="10-user-defined-functions.html"><a href="10-user-defined-functions.html#browser"><i class="fa fa-check"></i><b>10.5.4</b> <code>browser</code></a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="10-user-defined-functions.html"><a href="10-user-defined-functions.html#scope"><i class="fa fa-check"></i><b>10.6</b> Scope</a></li>
<li class="chapter" data-level="10.7" data-path="10-user-defined-functions.html"><a href="10-user-defined-functions.html#exercises-10"><i class="fa fa-check"></i><b>10.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html"><i class="fa fa-check"></i><b>11</b> String Manipulation</a><ul>
<li class="chapter" data-level="11.1" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#base-function"><i class="fa fa-check"></i><b>11.1</b> Base function</a></li>
<li class="chapter" data-level="11.2" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#stringr-basic-operations"><i class="fa fa-check"></i><b>11.2</b> <code>stringr</code>: Basic operations</a><ul>
<li class="chapter" data-level="11.2.1" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#concatenating-with-str_c-or-str_join"><i class="fa fa-check"></i><b>11.2.1</b> Concatenating with <code>str_c()</code> or <code>str_join()</code></a></li>
<li class="chapter" data-level="11.2.2" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#calculating-string-length-with-str_length"><i class="fa fa-check"></i><b>11.2.2</b> Calculating string length with <code>str_length()</code></a></li>
<li class="chapter" data-level="11.2.3" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#extracting-substrings-with-str_sub"><i class="fa fa-check"></i><b>11.2.3</b> Extracting substrings with <code>str_sub()</code></a></li>
<li class="chapter" data-level="11.2.4" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#pad-a-string-with-str_pad"><i class="fa fa-check"></i><b>11.2.4</b> Pad a string with <code>str_pad()</code></a></li>
<li class="chapter" data-level="11.2.5" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#trim-a-string-with-str_trim"><i class="fa fa-check"></i><b>11.2.5</b> Trim a string with <code>str_trim()</code></a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#stringr-pattern-matching-tools"><i class="fa fa-check"></i><b>11.3</b> <code>stringr</code>: Pattern Matching Tools</a><ul>
<li class="chapter" data-level="11.3.1" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#detecting-a-pattern-using-str_detect"><i class="fa fa-check"></i><b>11.3.1</b> Detecting a pattern using str_detect()</a></li>
<li class="chapter" data-level="11.3.2" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#locating-a-pattern-using-str_locate"><i class="fa fa-check"></i><b>11.3.2</b> Locating a pattern using str_locate()</a></li>
<li class="chapter" data-level="11.3.3" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#replacing-sub-strings-using-str_replace"><i class="fa fa-check"></i><b>11.3.3</b> Replacing sub-strings using <code>str_replace()</code></a></li>
<li class="chapter" data-level="11.3.4" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#splitting-into-sub-strings-using-str_split"><i class="fa fa-check"></i><b>11.3.4</b> Splitting into sub-strings using <code>str_split()</code></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#regular-expressions"><i class="fa fa-check"></i><b>11.4</b> Regular Expressions</a><ul>
<li class="chapter" data-level="11.4.1" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#regular-expression-ingredients"><i class="fa fa-check"></i><b>11.4.1</b> Regular Expression Ingredients</a></li>
<li class="chapter" data-level="11.4.2" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#matching-a-specific-string"><i class="fa fa-check"></i><b>11.4.2</b> Matching a specific string</a></li>
<li class="chapter" data-level="11.4.3" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#matching-arbitrary-numbers"><i class="fa fa-check"></i><b>11.4.3</b> Matching arbitrary numbers</a></li>
<li class="chapter" data-level="11.4.4" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#greedy-matching"><i class="fa fa-check"></i><b>11.4.4</b> Greedy matching</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#exercises-11"><i class="fa fa-check"></i><b>11.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="12-dates-and-times.html"><a href="12-dates-and-times.html"><i class="fa fa-check"></i><b>12</b> Dates and Times</a><ul>
<li class="chapter" data-level="12.1" data-path="12-dates-and-times.html"><a href="12-dates-and-times.html#creating-date-and-time-objects"><i class="fa fa-check"></i><b>12.1</b> Creating Date and Time objects</a></li>
<li class="chapter" data-level="12.2" data-path="12-dates-and-times.html"><a href="12-dates-and-times.html#extracting-information"><i class="fa fa-check"></i><b>12.2</b> Extracting information</a></li>
<li class="chapter" data-level="12.3" data-path="12-dates-and-times.html"><a href="12-dates-and-times.html#arithmetic-on-dates"><i class="fa fa-check"></i><b>12.3</b> Arithmetic on Dates</a></li>
<li class="chapter" data-level="12.4" data-path="12-dates-and-times.html"><a href="12-dates-and-times.html#exercises-12"><i class="fa fa-check"></i><b>12.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="13-graphing-part-ii.html"><a href="13-graphing-part-ii.html"><i class="fa fa-check"></i><b>13</b> Graphing Part II</a><ul>
<li class="chapter" data-level="13.1" data-path="13-graphing-part-ii.html"><a href="13-graphing-part-ii.html#multi-plots"><i class="fa fa-check"></i><b>13.1</b> Multi-plots</a><ul>
<li class="chapter" data-level="13.1.1" data-path="13-graphing-part-ii.html"><a href="13-graphing-part-ii.html#cowplot-package"><i class="fa fa-check"></i><b>13.1.1</b> <code>cowplot</code> package</a></li>
<li class="chapter" data-level="13.1.2" data-path="13-graphing-part-ii.html"><a href="13-graphing-part-ii.html#multiplot-in-rmisc"><i class="fa fa-check"></i><b>13.1.2</b> <code>multiplot</code> in <code>Rmisc</code></a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="13-graphing-part-ii.html"><a href="13-graphing-part-ii.html#customized-scales"><i class="fa fa-check"></i><b>13.2</b> Customized Scales</a><ul>
<li class="chapter" data-level="13.2.1" data-path="13-graphing-part-ii.html"><a href="13-graphing-part-ii.html#color-scales"><i class="fa fa-check"></i><b>13.2.1</b> Color Scales</a></li>
<li class="chapter" data-level="13.2.2" data-path="13-graphing-part-ii.html"><a href="13-graphing-part-ii.html#setting-major-minor-ticks"><i class="fa fa-check"></i><b>13.2.2</b> Setting major &amp; minor ticks</a></li>
<li class="chapter" data-level="13.2.3" data-path="13-graphing-part-ii.html"><a href="13-graphing-part-ii.html#log-scales"><i class="fa fa-check"></i><b>13.2.3</b> Log Scales</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="13-graphing-part-ii.html"><a href="13-graphing-part-ii.html#geographic-maps"><i class="fa fa-check"></i><b>13.3</b> Geographic Maps</a><ul>
<li class="chapter" data-level="13.3.1" data-path="13-graphing-part-ii.html"><a href="13-graphing-part-ii.html#package-maps"><i class="fa fa-check"></i><b>13.3.1</b> Package <code>maps</code></a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="13-graphing-part-ii.html"><a href="13-graphing-part-ii.html#exercises-13"><i class="fa fa-check"></i><b>13.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="14-data-reshaping.html"><a href="14-data-reshaping.html"><i class="fa fa-check"></i><b>14</b> Data Reshaping</a><ul>
<li class="chapter" data-level="14.1" data-path="14-data-reshaping.html"><a href="14-data-reshaping.html#cbind-rbind"><i class="fa fa-check"></i><b>14.1</b> <code>cbind</code> &amp; <code>rbind</code></a></li>
<li class="chapter" data-level="14.2" data-path="14-data-reshaping.html"><a href="14-data-reshaping.html#tidyr"><i class="fa fa-check"></i><b>14.2</b> <code>tidyr</code></a><ul>
<li class="chapter" data-level="14.2.1" data-path="14-data-reshaping.html"><a href="14-data-reshaping.html#verbs-1"><i class="fa fa-check"></i><b>14.2.1</b> Verbs</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="14-data-reshaping.html"><a href="14-data-reshaping.html#storing-data-in-multiple-tables"><i class="fa fa-check"></i><b>14.3</b> Storing Data in Multiple Tables</a></li>
<li class="chapter" data-level="14.4" data-path="14-data-reshaping.html"><a href="14-data-reshaping.html#table-joins"><i class="fa fa-check"></i><b>14.4</b> Table Joins</a></li>
<li class="chapter" data-level="14.5" data-path="14-data-reshaping.html"><a href="14-data-reshaping.html#exercises-14"><i class="fa fa-check"></i><b>14.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="15-data-scraping.html"><a href="15-data-scraping.html"><i class="fa fa-check"></i><b>15</b> Data Scraping</a><ul>
<li class="chapter" data-level="15.1" data-path="15-data-scraping.html"><a href="15-data-scraping.html#web-pages"><i class="fa fa-check"></i><b>15.1</b> Web Pages</a><ul>
<li class="chapter" data-level="15.1.1" data-path="15-data-scraping.html"><a href="15-data-scraping.html#example-wikipedia-table"><i class="fa fa-check"></i><b>15.1.1</b> Example Wikipedia Table</a></li>
<li class="chapter" data-level="15.1.2" data-path="15-data-scraping.html"><a href="15-data-scraping.html#lists-1"><i class="fa fa-check"></i><b>15.1.2</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="15-data-scraping.html"><a href="15-data-scraping.html#scraping-.pdf-files"><i class="fa fa-check"></i><b>15.2</b> Scraping .pdf files</a></li>
<li class="chapter" data-level="15.3" data-path="15-data-scraping.html"><a href="15-data-scraping.html#exercises-15"><i class="fa fa-check"></i><b>15.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="16-r-packages.html"><a href="16-r-packages.html"><i class="fa fa-check"></i><b>16</b> R Packages</a><ul>
<li class="chapter" data-level="16.1" data-path="16-r-packages.html"><a href="16-r-packages.html#introduction"><i class="fa fa-check"></i><b>16.1</b> Introduction</a><ul>
<li class="chapter" data-level="16.1.1" data-path="16-r-packages.html"><a href="16-r-packages.html#useful-packages-and-books"><i class="fa fa-check"></i><b>16.1.1</b> Useful packages and books</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="16-r-packages.html"><a href="16-r-packages.html#package-structure"><i class="fa fa-check"></i><b>16.2</b> Package Structure</a><ul>
<li class="chapter" data-level="16.2.1" data-path="16-r-packages.html"><a href="16-r-packages.html#minimal-files-and-directories"><i class="fa fa-check"></i><b>16.2.1</b> Minimal files and directories</a></li>
<li class="chapter" data-level="16.2.2" data-path="16-r-packages.html"><a href="16-r-packages.html#optional-files-and-directories"><i class="fa fa-check"></i><b>16.2.2</b> Optional Files and Directories</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="16-r-packages.html"><a href="16-r-packages.html#documenting"><i class="fa fa-check"></i><b>16.3</b> Documenting</a><ul>
<li class="chapter" data-level="16.3.1" data-path="16-r-packages.html"><a href="16-r-packages.html#dataset-documentation"><i class="fa fa-check"></i><b>16.3.1</b> Dataset Documentation</a></li>
<li class="chapter" data-level="16.3.2" data-path="16-r-packages.html"><a href="16-r-packages.html#documenting-functions"><i class="fa fa-check"></i><b>16.3.2</b> Documenting Functions</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="16-r-packages.html"><a href="16-r-packages.html#the-description-file"><i class="fa fa-check"></i><b>16.4</b> The DESCRIPTION file</a><ul>
<li class="chapter" data-level="16.4.1" data-path="16-r-packages.html"><a href="16-r-packages.html#a-simple-analysis-package"><i class="fa fa-check"></i><b>16.4.1</b> A Simple Analysis Package</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="16-r-packages.html"><a href="16-r-packages.html#sharing-your-package"><i class="fa fa-check"></i><b>16.5</b> Sharing your Package</a></li>
<li class="chapter" data-level="16.6" data-path="16-r-packages.html"><a href="16-r-packages.html#exercises-16"><i class="fa fa-check"></i><b>16.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="17-speeding-up-r.html"><a href="17-speeding-up-r.html"><i class="fa fa-check"></i><b>17</b> Speeding up R</a><ul>
<li class="chapter" data-level="17.1" data-path="17-speeding-up-r.html"><a href="17-speeding-up-r.html#faster-for-loops"><i class="fa fa-check"></i><b>17.1</b> Faster for loops?</a></li>
<li class="chapter" data-level="17.2" data-path="17-speeding-up-r.html"><a href="17-speeding-up-r.html#vectorizing-loops"><i class="fa fa-check"></i><b>17.2</b> Vectorizing loops</a></li>
<li class="chapter" data-level="17.3" data-path="17-speeding-up-r.html"><a href="17-speeding-up-r.html#parallel-processing"><i class="fa fa-check"></i><b>17.3</b> Parallel Processing</a></li>
<li class="chapter" data-level="17.4" data-path="17-speeding-up-r.html"><a href="17-speeding-up-r.html#parallelizing-for-loops"><i class="fa fa-check"></i><b>17.4</b> Parallelizing for loops</a></li>
<li class="chapter" data-level="17.5" data-path="17-speeding-up-r.html"><a href="17-speeding-up-r.html#parallel-aware-functions"><i class="fa fa-check"></i><b>17.5</b> Parallel Aware Functions</a><ul>
<li class="chapter" data-level="17.5.1" data-path="17-speeding-up-r.html"><a href="17-speeding-up-r.html#bootboot"><i class="fa fa-check"></i><b>17.5.1</b> <code>boot::boot</code></a></li>
<li class="chapter" data-level="17.5.2" data-path="17-speeding-up-r.html"><a href="17-speeding-up-r.html#carettrain"><i class="fa fa-check"></i><b>17.5.2</b> <code>caret::train</code></a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STA 444/5 - Introductory Data Science using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="user-defined-functions" class="section level1">
<h1><span class="header-section-number">Chapter 10</span> User Defined Functions</h1>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb467-1" data-line-number="1"><span class="kw">library</span>(tidyverse)  </a></code></pre></div>
<p>It is very important to be able to define a piece of programming logic that is repeated often. For example, I don’t want to have to always program the mathematical code for calculating the sample variance of a vector of data. Instead I just want to call a function that does everything for me and I don’t have to worry about the details.</p>
<p>While hiding the computational details is nice, fundamentally writing functions allows us to think about our problems at a higher layer of abstraction. For example, most scientists just want to run a t-test on their data and get the appropriate p-value out; they want to focus on their problem and not how to calculate what the appropriate degrees of freedom are. Functions let us do that.</p>
<div id="basic-function-definition" class="section level2">
<h2><span class="header-section-number">10.1</span> Basic function definition</h2>
<p>In the course of your analysis, it can be useful to define your own functions. The format for defining your own function is</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb468-1" data-line-number="1">function.name &lt;-<span class="st"> </span><span class="cf">function</span>(arg1, arg2, arg3){</a>
<a class="sourceLine" id="cb468-2" data-line-number="2">  statement1</a>
<a class="sourceLine" id="cb468-3" data-line-number="3">  statement2</a>
<a class="sourceLine" id="cb468-4" data-line-number="4">}</a></code></pre></div>
<p>where <code>arg1</code> is the first argument passed to the function and <code>arg2</code> is the second.</p>
<p>To illustrate how to define your own function, we will define a variance calculating function.</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb469-1" data-line-number="1"><span class="co"># define my function</span></a>
<a class="sourceLine" id="cb469-2" data-line-number="2">my.var &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb469-3" data-line-number="3">  n &lt;-<span class="st"> </span><span class="kw">length</span>(x)                <span class="co"># calculate sample size</span></a>
<a class="sourceLine" id="cb469-4" data-line-number="4">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)               <span class="co"># calculate sample mean</span></a>
<a class="sourceLine" id="cb469-5" data-line-number="5">  SSE &lt;-<span class="st"> </span><span class="kw">sum</span>( (x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">2</span> )      <span class="co"># calculate sum of squared error</span></a>
<a class="sourceLine" id="cb469-6" data-line-number="6">  v &lt;-<span class="st"> </span>SSE <span class="op">/</span><span class="st"> </span>( n <span class="op">-</span><span class="st"> </span><span class="dv">1</span> )          <span class="co"># &quot;average&quot; squared error</span></a>
<a class="sourceLine" id="cb469-7" data-line-number="7">  <span class="kw">return</span>(v)                     <span class="co"># result of function is v</span></a>
<a class="sourceLine" id="cb469-8" data-line-number="8">}</a></code></pre></div>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb470-1" data-line-number="1"><span class="co"># create a vector that I wish to calculate the variance of</span></a>
<a class="sourceLine" id="cb470-2" data-line-number="2">test.vector &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb470-3" data-line-number="3"></a>
<a class="sourceLine" id="cb470-4" data-line-number="4"><span class="co"># calculate the variance using my function</span></a>
<a class="sourceLine" id="cb470-5" data-line-number="5">calculated.var &lt;-<span class="st"> </span><span class="kw">my.var</span>( test.vector )</a>
<a class="sourceLine" id="cb470-6" data-line-number="6">calculated.var</a></code></pre></div>
<pre><code>## [1] 2.7</code></pre>
<p>Notice that even though I defined my function using <code>x</code> as my vector of data, and passed my function something named <code>test.vector</code>, R does the appropriate renaming.If my function doesn’t modify its input arguments, then R just passes a pointer to the inputs to avoid copying large amounts of data when you call a function. If your function modifies its input, then R will take the input data, copy it, and then pass that new copy to the function. This means that a function cannot modify its arguments. In Computer Science parlance, R does not allow for procedural side effects. Think of the variable <code>x</code> as a placeholder, with it being replaced by whatever gets passed into the function.</p>
<p>When I call a function, the function might cause something to happen (e.g. draw a plot) or it might do some calculates the result is returned by the function and we might want to save that. Inside a function, if I want the result of some calculation saved, I return the result as the output of the function. The way I specify to do this is via the <code>return</code> statement. (Actually R doesn’t completely require this. But the alternative method is less intuitive and I strongly recommend using the <code>return()</code> statement for readability.)</p>
<p>By writing a function, I can use the same chunk of code repeatedly. This means that I can do all my tedious calculations inside the function and just call the function whenever I want and happily ignore the details. Consider the function <code>t.test()</code> which we have used to do all the calculations in a t-test. We could write a similar function using the following code:</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb472-1" data-line-number="1"><span class="co"># define my function</span></a>
<a class="sourceLine" id="cb472-2" data-line-number="2">one.sample.t.test &lt;-<span class="st"> </span><span class="cf">function</span>(input.data, mu0){</a>
<a class="sourceLine" id="cb472-3" data-line-number="3">  n    &lt;-<span class="st"> </span><span class="kw">length</span>(input.data)</a>
<a class="sourceLine" id="cb472-4" data-line-number="4">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(input.data)</a>
<a class="sourceLine" id="cb472-5" data-line-number="5">  s    &lt;-<span class="st"> </span><span class="kw">sd</span>(input.data)</a>
<a class="sourceLine" id="cb472-6" data-line-number="6">  t    &lt;-<span class="st"> </span>(xbar <span class="op">-</span><span class="st"> </span>mu0)<span class="op">/</span>(s <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n))</a>
<a class="sourceLine" id="cb472-7" data-line-number="7">  <span class="cf">if</span>( t <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> ){</a>
<a class="sourceLine" id="cb472-8" data-line-number="8">    p.value &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">pt</span>(t, <span class="dt">df=</span>n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb472-9" data-line-number="9">  }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb472-10" data-line-number="10">    p.value &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(t, <span class="dt">df=</span>n<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb472-11" data-line-number="11">  }</a>
<a class="sourceLine" id="cb472-12" data-line-number="12">  <span class="co"># we haven&#39;t addressed how to print things in a organized </span></a>
<a class="sourceLine" id="cb472-13" data-line-number="13">  <span class="co"># fashion, the following is ugly, but works...</span></a>
<a class="sourceLine" id="cb472-14" data-line-number="14">  <span class="co"># Notice that this function returns a character string</span></a>
<a class="sourceLine" id="cb472-15" data-line-number="15">  <span class="co"># with the necessary information in the string.</span></a>
<a class="sourceLine" id="cb472-16" data-line-number="16">  <span class="kw">return</span>( <span class="kw">paste</span>(<span class="st">&#39;t =&#39;</span>, <span class="kw">round</span>(t, <span class="dt">digits=</span><span class="dv">3</span>), <span class="st">&#39; and p.value =&#39;</span>, <span class="kw">round</span>(p.value, <span class="dv">3</span>)) )</a>
<a class="sourceLine" id="cb472-17" data-line-number="17">}</a></code></pre></div>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb473-1" data-line-number="1"><span class="co"># create a vector that I wish apply a one-sample t-test on.</span></a>
<a class="sourceLine" id="cb473-2" data-line-number="2">test.data &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb473-3" data-line-number="3"><span class="kw">one.sample.t.test</span>( test.data, <span class="dt">mu0=</span><span class="dv">2</span> )</a></code></pre></div>
<pre><code>## [1] &quot;t = 3.157  and p.value = 0.008&quot;</code></pre>
<p>Nearly every function we use to do data analysis is written in a similar fashion. Somebody decided it would be convenient to have a function that did an ANOVA analysis and they wrote something similar to the above function, but is a bit grander in scope. Even if you don’t end up writing any of your own functions, knowing how to will help you understand why certain functions you use are designed the way they are.</p>
</div>
<div id="parameter-defaults" class="section level2">
<h2><span class="header-section-number">10.2</span> Parameter Defaults</h2>
<p>When I define a function and can let it take as many arguments as I want and I can also give default values to the arguments. For example we can define the normal density function using the following code which gives a default mean of <span class="math inline">\(0\)</span> and default standard deviation of <span class="math inline">\(1\)</span>.</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb475-1" data-line-number="1"><span class="co"># a function that defines the shape of a normal distribution.</span></a>
<a class="sourceLine" id="cb475-2" data-line-number="2"><span class="co"># by including mu=0, we give a default value that the function</span></a>
<a class="sourceLine" id="cb475-3" data-line-number="3"><span class="co"># user can override</span></a>
<a class="sourceLine" id="cb475-4" data-line-number="4">dnorm.alternate &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">mu=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb475-5" data-line-number="5">  out &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(sd <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)) <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>( <span class="op">-</span>(x<span class="op">-</span>mu)<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>sd<span class="op">^</span><span class="dv">2</span>) )</a>
<a class="sourceLine" id="cb475-6" data-line-number="6">  <span class="kw">return</span>(out)</a>
<a class="sourceLine" id="cb475-7" data-line-number="7">}</a></code></pre></div>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb476-1" data-line-number="1"><span class="co"># test the function to see if it works</span></a>
<a class="sourceLine" id="cb476-2" data-line-number="2"><span class="kw">dnorm.alternate</span>(<span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] 0.2419707</code></pre>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb478-1" data-line-number="1"><span class="kw">dnorm.alternate</span>(<span class="dv">1</span>, <span class="dt">mu=</span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] 0.3989423</code></pre>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb480-1" data-line-number="1"><span class="co"># Lets test the function a bit more by drawing the height</span></a>
<a class="sourceLine" id="cb480-2" data-line-number="2"><span class="co"># of the normal distribution a lots of different points</span></a>
<a class="sourceLine" id="cb480-3" data-line-number="3"><span class="co"># ... First the standard normal!</span></a>
<a class="sourceLine" id="cb480-4" data-line-number="4"><span class="kw">data.frame</span>( <span class="dt">x =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dt">length=</span><span class="dv">601</span>) ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb480-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>( <span class="dt">y =</span> <span class="kw">dnorm.alternate</span>(x) )       <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># use default mu=0, sd=1</span></a>
<a class="sourceLine" id="cb480-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>( <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>()</a></code></pre></div>
<p><img src="21_Functions_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb481-1" data-line-number="1"><span class="co"># next a normal with mean 1, and standard deviation 1</span></a>
<a class="sourceLine" id="cb481-2" data-line-number="2"><span class="kw">data.frame</span>( <span class="dt">x =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dt">length=</span><span class="dv">601</span>) ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb481-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>( <span class="dt">y =</span> <span class="kw">dnorm.alternate</span>(x, <span class="dt">mu=</span><span class="dv">1</span>) )       <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># use mu=1, sd=1</span></a>
<a class="sourceLine" id="cb481-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>( <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y) ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>()</a></code></pre></div>
<p><img src="21_Functions_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Many functions that we use have defaults that we don’t normally mess with. For example, the function <code>mean()</code> has an option the specifies what it should do if your vector of data has missing data. The common solution is to remove those observations, but we might have wanted to say that the mean is unknown one component of it was unknown.</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb482-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="ot">NA</span>)     <span class="co"># fourth element is missing</span></a>
<a class="sourceLine" id="cb482-2" data-line-number="2"><span class="kw">mean</span>(x)              <span class="co"># default is to return NA if any element is missing</span></a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb484-1" data-line-number="1"><span class="kw">mean</span>(x, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)  <span class="co"># Only average the non-missing data</span></a></code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>As you look at the help pages for different functions, you’ll see in the function definitions what the default values are. For example, the function <code>mean</code> has another option, <code>trim</code>, which specifies what percent of the data to trim at the extremes. Because we would expect mean to not do any trimming by default, the authors have appropriately defined the default amount of trimming to be zero via the definition <code>trim=0</code>.</p>
</div>
<div id="ellipses" class="section level2">
<h2><span class="header-section-number">10.3</span> Ellipses</h2>
<p>When writing functions, I occasionally have a situation where I call function <code>a()</code> and function <code>a()</code> needs to call another function, say <code>b()</code>, and I want to pass an unusual parameter to that function. To do this, I’ll use a set of three periods called an <em>ellipses</em>. What these do is represent a set of parameter values that will be passed along to a subsequent function.For example the following code takes the result of a simple linear regression and plots the data and the regression line and confidence region (basically I’m recreating a function that does the same thing as ggplot2’s geom_smooth() layer). I might not want to specify (and give good defaults) to every single graphical parameter that the plot() function supports. Instead I’ll just use the ‘…’ argument and pass any additional parameters to the plot function.</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb486-1" data-line-number="1"><span class="co"># a function that draws the regression line and confidence interval</span></a>
<a class="sourceLine" id="cb486-2" data-line-number="2"><span class="co"># notice it doesn&#39;t return anything... all it does is draw a plot</span></a>
<a class="sourceLine" id="cb486-3" data-line-number="3">show.lm &lt;-<span class="st"> </span><span class="cf">function</span>(m, <span class="dt">interval.type=</span><span class="st">&#39;confidence&#39;</span>, <span class="dt">fill.col=</span><span class="st">&#39;light grey&#39;</span>, ...){</a>
<a class="sourceLine" id="cb486-4" data-line-number="4">  df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb486-5" data-line-number="5">    <span class="dt">x =</span> m<span class="op">$</span>model[,<span class="dv">2</span>],     <span class="co"># extract the predictor variable</span></a>
<a class="sourceLine" id="cb486-6" data-line-number="6">    <span class="dt">y =</span> m<span class="op">$</span>model[,<span class="dv">1</span>]       <span class="co"># extract the response</span></a>
<a class="sourceLine" id="cb486-7" data-line-number="7">  )</a>
<a class="sourceLine" id="cb486-8" data-line-number="8">  df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cbind</span>( <span class="kw">predict</span>(m, <span class="dt">interval=</span>interval.type) )</a>
<a class="sourceLine" id="cb486-9" data-line-number="9">  P &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>x) ) <span class="op">+</span></a>
<a class="sourceLine" id="cb486-10" data-line-number="10"><span class="st">    </span><span class="kw">geom_ribbon</span>( <span class="kw">aes</span>(<span class="dt">ymin=</span>lwr, <span class="dt">ymax=</span>upr), <span class="dt">fill=</span>fill.col ) <span class="op">+</span></a>
<a class="sourceLine" id="cb486-11" data-line-number="11"><span class="st">    </span><span class="kw">geom_line</span>( <span class="kw">aes</span>(<span class="dt">y=</span>fit), ... ) <span class="op">+</span></a>
<a class="sourceLine" id="cb486-12" data-line-number="12"><span class="st">    </span><span class="kw">geom_point</span>( <span class="kw">aes</span>(<span class="dt">y=</span>y), ... ) <span class="op">+</span></a>
<a class="sourceLine" id="cb486-13" data-line-number="13"><span class="st">    </span><span class="kw">labs</span>(...)</a>
<a class="sourceLine" id="cb486-14" data-line-number="14">  <span class="kw">print</span>(P)</a>
<a class="sourceLine" id="cb486-15" data-line-number="15">} </a></code></pre></div>
<p>This function looks daunting, but we experiment to see what it does.</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb487-1" data-line-number="1"><span class="co"># first define a simple linear model from our cherry tree data</span></a>
<a class="sourceLine" id="cb487-2" data-line-number="2">m &lt;-<span class="st"> </span><span class="kw">lm</span>( Volume <span class="op">~</span><span class="st"> </span>Girth, <span class="dt">data=</span>trees )</a>
<a class="sourceLine" id="cb487-3" data-line-number="3"></a>
<a class="sourceLine" id="cb487-4" data-line-number="4"><span class="co"># call the function with no extraneous parameters</span></a>
<a class="sourceLine" id="cb487-5" data-line-number="5"><span class="kw">show.lm</span>( m )</a></code></pre></div>
<p><img src="21_Functions_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb488-1" data-line-number="1"><span class="co"># Pass arguments that will just be passed along to the geom layers </span></a>
<a class="sourceLine" id="cb488-2" data-line-number="2"><span class="kw">show.lm</span>( m, <span class="dt">color=</span><span class="st">&#39;Red&#39;</span>, <span class="dt">title=</span><span class="st">&#39;Relationship between Girth and Volume&#39;</span>)</a></code></pre></div>
<pre><code>## Warning: Ignoring unknown parameters: title

## Warning: Ignoring unknown parameters: title</code></pre>
<p><img src="21_Functions_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>This type of trick is done commonly. Look at the help files for <code>hist()</code> and <code>qqnorm()</code> and you’ll see the ellipses used to pass graphical parameters along to sub-functions. Functions like <code>lm()</code> use the ellipses to pass arguments to the low level regression fitting functions that do the actual calculations. By only including these parameters via the ellipses, must users won’t be tempted to mess with the parameters, but experts who know the nitty-gritty details can still modify those parameters.</p>
</div>
<div id="function-overloading" class="section level2">
<h2><span class="header-section-number">10.4</span> Function Overloading</h2>
<p>Frequently the user wants to inspect the results of some calculation and display a variable or object to the screen. The <code>print()</code> function does exactly that, but it acts differently for matrices than it does for vectors. It especially acts different for lists that I obtained from a call like <code>lm()</code> or <code>aov()</code>.</p>
<p>The reason that the print function can act differently depending on the object type that I pass it is because the function <code>print()</code> is <em>overloaded</em>. What this means is that there is a <code>print.lm()</code> function that is called whenever I call <code>print(obj)</code> when <code>obj</code> is the output of an <code>lm()</code> command.</p>
<p>Recall that we initially introduced a few different classes of data, Numerical, Factors, and Logicals. It turns out that I can create more types of classes.</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb490-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb490-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="dv">3</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>x<span class="op">+</span><span class="kw">rnorm</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb490-3" data-line-number="3"></a>
<a class="sourceLine" id="cb490-4" data-line-number="4">h &lt;-<span class="st"> </span><span class="kw">hist</span>(y)  <span class="co"># h should be of class &quot;Histogram&quot;</span></a></code></pre></div>
<p><img src="21_Functions_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb491-1" data-line-number="1"><span class="kw">class</span>(h)</a></code></pre></div>
<pre><code>## [1] &quot;histogram&quot;</code></pre>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb493-1" data-line-number="1">model &lt;-<span class="st"> </span><span class="kw">lm</span>( y <span class="op">~</span><span class="st"> </span>x ) <span class="co"># model is something of class &quot;lm&quot;</span></a>
<a class="sourceLine" id="cb493-2" data-line-number="2"><span class="kw">class</span>(model)</a></code></pre></div>
<pre><code>## [1] &quot;lm&quot;</code></pre>
<p>Many common functions such as <code>plot()</code> are overloaded so that when I call the plot function with an object, it will in turn call <code>plot.lm()</code> or <code>plot.histogram()</code> as appropriate. When building statistical models I am often interested in different quantities and would like to get those regardless of the model I am using. Below are a list of functions that work whether I fit a model via <code>aov()</code>, <code>lm()</code>, <code>glm()</code>, or <code>gam()</code>.</p>
<table style="width:64%;">
<colgroup>
<col width="31%" />
<col width="31%" />
</colgroup>
<thead>
<tr class="header">
<th>Quantity</th>
<th>Function Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Residuals</td>
<td><code>resid( obj )</code></td>
</tr>
<tr class="even">
<td>Model Coefficients</td>
<td><code>coef( obj )</code></td>
</tr>
<tr class="odd">
<td>Summary Table</td>
<td><code>summary( obj )</code></td>
</tr>
<tr class="even">
<td>ANOVA Table</td>
<td><code>anova( obj )</code></td>
</tr>
<tr class="odd">
<td>AIC value</td>
<td><code>AIC( obj )</code></td>
</tr>
</tbody>
</table>
<p>For the residual function, there exists a <code>resid.lm()</code> function, and <code>resid.gam()</code> and it is these functions are called when we run the command <code>resid( obj )</code>.</p>
</div>
<div id="debugging" class="section level2">
<h2><span class="header-section-number">10.5</span> Debugging</h2>
<p>When writing code, it is often necessary to figure out why the written code does not behave in the manner the writer expects. This process can be extremely challenging. Various types of tools have been developed and are incorporated in any reasonable integrated development environment (including RStudio!). All of the techniques we’ll discuss are intended to help the developer understand exactly what the variable environment is like during the code execution.</p>
<p>RStudio has a <a href="https://support.rstudio.com/hc/en-us/articles/200713843">support article</a> about using the debugger mode in a variety of situations so these notes won’t go into extreme detail about different scenarios. Instead we’ll focus on <em>how</em> to debug.</p>
<div id="rmarkdown-recommendations" class="section level3">
<h3><span class="header-section-number">10.5.1</span> Rmarkdown Recommendations</h3>
<p>Because Rmarkdown documents are knitted using completely a completely fresh instance of R, I recommend that whenever you start up RStudio, it starts with a completely fresh instance of R. This means that it shouldn’t load any history or previously created objects. To make this the default behavior, go to the <code>RStudio -&gt; Preferences</code> on a Mac or <code>Tools -&gt; Global Options</code> on a PC. On the <code>R General</code> section un-select all of the <code>Workspace</code> and <code>History</code> options.</p>
</div>
<div id="step-wise-execution" class="section level3">
<h3><span class="header-section-number">10.5.2</span> Step-wise Execution</h3>
<p>Often we can understand where an error is being introduced by simply running each step individually and inspecting the result. This is where the <code>Evironment</code> tab in the top right panel (unless you’ve moved it…) becomes helpful. By watching how the objects of interest change as we step through the code, we can more easily see where errors have occurred. For complicated objects such as <code>data.frames</code>, I find it helpful to have them opened in a <code>View</code> tab.</p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb495-1" data-line-number="1">iris.summary &lt;-<span class="st"> </span>iris <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb495-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Sepal.Area =</span> Sepal.Width <span class="op">*</span><span class="st"> </span>Sepal.Length,</a>
<a class="sourceLine" id="cb495-3" data-line-number="3">         <span class="dt">Petal.Area =</span> Petal.Width <span class="op">*</span><span class="st"> </span>Petal.Length) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb495-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(Species, Sepal.Area, Petal.Area) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb495-5" data-line-number="5"><span class="st">  </span><span class="kw">group_by</span>(Speces) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb495-6" data-line-number="6"><span class="st">  </span><span class="kw">summarize</span>( <span class="dt">Mean.Sepal.Area =</span> <span class="kw">mean</span>(Sepal.Area),</a>
<a class="sourceLine" id="cb495-7" data-line-number="7">             <span class="dt">Mean.Petal.Area =</span> <span class="kw">mean</span>(Petal.Area) )</a></code></pre></div>
<p>In this case, I would execute the <code>iris %&gt;% ...</code> section of code and add one command after another until I finally found the line of code that produces the error. Once the line containing the error has been identified, I look for misspellings, misplaced parentheses, or a disconnect between what the input structure is versus what the code expects.</p>
</div>
<div id="print-statements" class="section level3">
<h3><span class="header-section-number">10.5.3</span> Print Statements</h3>
<p>Once we start writing code with loops and functions, a simple step-by-step evaluation won’t suffice. An easy way to quickly see what the state of a variable is at some point in the code is to add a <code>print()</code> command that outputs some useful information about the environment.</p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb496-1" data-line-number="1"><span class="co">#&#39; Compute a Factorial. e.g. 5! = 5*4*3*2*1 </span></a>
<a class="sourceLine" id="cb496-2" data-line-number="2"><span class="co">#&#39; @param n A positive integer</span></a>
<a class="sourceLine" id="cb496-3" data-line-number="3"><span class="co">#&#39; @return The value of n!</span></a>
<a class="sourceLine" id="cb496-4" data-line-number="4">factorial &lt;-<span class="st"> </span><span class="cf">function</span>(n){</a>
<a class="sourceLine" id="cb496-5" data-line-number="5">  output &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb496-6" data-line-number="6">  <span class="cf">for</span>( i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n ){</a>
<a class="sourceLine" id="cb496-7" data-line-number="7">    output &lt;-<span class="st"> </span>output<span class="op">*</span>i</a>
<a class="sourceLine" id="cb496-8" data-line-number="8">  }</a>
<a class="sourceLine" id="cb496-9" data-line-number="9">  <span class="kw">return</span>(output)</a>
<a class="sourceLine" id="cb496-10" data-line-number="10">}</a>
<a class="sourceLine" id="cb496-11" data-line-number="11"></a>
<a class="sourceLine" id="cb496-12" data-line-number="12"><span class="kw">factorial</span>(<span class="dv">5</span>)</a></code></pre></div>
<pre><code>## integer(0)</code></pre>
<p>In this case, I would add a few print statements such as the following:</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb498-1" data-line-number="1"><span class="co">#&#39; Compute a Factorial. e.g. 5! = 5*4*3*2*1 </span></a>
<a class="sourceLine" id="cb498-2" data-line-number="2"><span class="co">#&#39; @param n A positive integer</span></a>
<a class="sourceLine" id="cb498-3" data-line-number="3"><span class="co">#&#39; @return The value of n!</span></a>
<a class="sourceLine" id="cb498-4" data-line-number="4">factorial &lt;-<span class="st"> </span><span class="cf">function</span>(n){</a>
<a class="sourceLine" id="cb498-5" data-line-number="5">  output &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb498-6" data-line-number="6">  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&#39;At Start and output = &#39;</span>, output))</a>
<a class="sourceLine" id="cb498-7" data-line-number="7">  <span class="cf">for</span>( i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n ){</a>
<a class="sourceLine" id="cb498-8" data-line-number="8">    output &lt;-<span class="st"> </span>output<span class="op">*</span>i</a>
<a class="sourceLine" id="cb498-9" data-line-number="9">    <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&#39;In Loop and i = &#39;</span>, i,<span class="st">&#39; and output = &#39;</span>, output))</a>
<a class="sourceLine" id="cb498-10" data-line-number="10">  }</a>
<a class="sourceLine" id="cb498-11" data-line-number="11">  <span class="kw">return</span>(output)</a>
<a class="sourceLine" id="cb498-12" data-line-number="12">}</a>
<a class="sourceLine" id="cb498-13" data-line-number="13"></a>
<a class="sourceLine" id="cb498-14" data-line-number="14"><span class="kw">factorial</span>(<span class="dv">5</span>)</a></code></pre></div>
<pre><code>## [1] &quot;At Start and output =  &quot;
## [1] &quot;In Loop and i =  1  and output =  &quot;
## [1] &quot;In Loop and i =  2  and output =  &quot;
## [1] &quot;In Loop and i =  3  and output =  &quot;
## [1] &quot;In Loop and i =  4  and output =  &quot;
## [1] &quot;In Loop and i =  5  and output =  &quot;</code></pre>
<pre><code>## integer(0)</code></pre>
<p>Hopefully we can now see that multiplying a <code>NULL</code> value by anything else continues to result in NULL values.</p>
</div>
<div id="browser" class="section level3">
<h3><span class="header-section-number">10.5.4</span> <code>browser</code></h3>
<p>Debugging is best done by stepping through the code while paying attention to the current values of all the variables of interest. Modern developer environments include a debugger which allows you to step through your code, one command at a time, while simultaneously showing you the variables of interest. To get into this environment, we need to set a <em>breakpoint</em>. This can be done in R-scripts by clicking on the line number, but in Rmarkdown files, it is done by including the command <code>browser()</code> into your code.</p>
<p>In our factorial function, we can set a breakpoint via the following</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb501-1" data-line-number="1"><span class="co">#&#39; Compute a Factorial. e.g. 5! = 5*4*3*2*1 </span></a>
<a class="sourceLine" id="cb501-2" data-line-number="2"><span class="co">#&#39; @param n A positive integer</span></a>
<a class="sourceLine" id="cb501-3" data-line-number="3"><span class="co">#&#39; @return The value of n!</span></a>
<a class="sourceLine" id="cb501-4" data-line-number="4">factorial &lt;-<span class="st"> </span><span class="cf">function</span>(n){</a>
<a class="sourceLine" id="cb501-5" data-line-number="5">  <span class="kw">browser</span>()</a>
<a class="sourceLine" id="cb501-6" data-line-number="6">  output &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb501-7" data-line-number="7">  <span class="cf">for</span>( i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n ){</a>
<a class="sourceLine" id="cb501-8" data-line-number="8">    output &lt;-<span class="st"> </span>output<span class="op">*</span>i</a>
<a class="sourceLine" id="cb501-9" data-line-number="9">  }</a>
<a class="sourceLine" id="cb501-10" data-line-number="10">  <span class="kw">return</span>(output)</a>
<a class="sourceLine" id="cb501-11" data-line-number="11">}</a>
<a class="sourceLine" id="cb501-12" data-line-number="12"></a>
<a class="sourceLine" id="cb501-13" data-line-number="13"><span class="co"># Now run the function</span></a>
<a class="sourceLine" id="cb501-14" data-line-number="14"><span class="kw">factorial</span>(<span class="dv">5</span>)</a></code></pre></div>
<p>This allows us to step through the function while simultaneously keeping track of all the variables we are interested in.</p>
</div>
</div>
<div id="scope" class="section level2">
<h2><span class="header-section-number">10.6</span> Scope</h2>
<p>Consider the case where we make a function that calculates the trimmed mean. A good implementation of the function is given here.</p>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb502-1" data-line-number="1"><span class="co">#&#39; Define a function for the trimmed mean</span></a>
<a class="sourceLine" id="cb502-2" data-line-number="2"><span class="co">#&#39; @param x A vector of values to be averaged</span></a>
<a class="sourceLine" id="cb502-3" data-line-number="3"><span class="co">#&#39; @param k The number of elements to trim on either side</span></a>
<a class="sourceLine" id="cb502-4" data-line-number="4"><span class="co">#&#39; @return A scalar</span></a>
<a class="sourceLine" id="cb502-5" data-line-number="5">trimmed.mean &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">k=</span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb502-6" data-line-number="6">  x &lt;-<span class="st"> </span><span class="kw">sort</span>(x)      <span class="co"># arrange the input according magnitude</span></a>
<a class="sourceLine" id="cb502-7" data-line-number="7">  n &lt;-<span class="st"> </span><span class="kw">length</span>(x)    <span class="co"># n = how many observations</span></a>
<a class="sourceLine" id="cb502-8" data-line-number="8">  <span class="cf">if</span>( k <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb502-9" data-line-number="9">    x &lt;-<span class="st"> </span>x[<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span><span class="op">*</span>(<span class="dv">1</span><span class="op">:</span>k), <span class="dv">-1</span><span class="op">*</span>((n<span class="op">-</span>k<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n))]  <span class="co"># remove first k, last k</span></a>
<a class="sourceLine" id="cb502-10" data-line-number="10">  }</a>
<a class="sourceLine" id="cb502-11" data-line-number="11">  tm &lt;-<span class="st"> </span><span class="kw">sum</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(x)  <span class="co"># mean of the remaining observations</span></a>
<a class="sourceLine" id="cb502-12" data-line-number="12">  <span class="kw">return</span>( tm )</a>
<a class="sourceLine" id="cb502-13" data-line-number="13">} </a>
<a class="sourceLine" id="cb502-14" data-line-number="14"></a>
<a class="sourceLine" id="cb502-15" data-line-number="15">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span><span class="op">:</span><span class="dv">1</span>,<span class="dv">50</span>)                        <span class="co"># 10, 9, 8, ..., 1</span></a>
<a class="sourceLine" id="cb502-16" data-line-number="16">output &lt;-<span class="st"> </span><span class="kw">trimmed.mean</span>(x, <span class="dt">k=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb502-17" data-line-number="17">output</a></code></pre></div>
<pre><code>## [1] 6</code></pre>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb504-1" data-line-number="1">x                                <span class="co"># notice x is unchanged</span></a></code></pre></div>
<pre><code>##  [1] 10  9  8  7  6  5  4  3  2  1 50</code></pre>
<p>Notice that even though I passed <code>x</code> into the function and then sorted it, <code>x</code> remained unsorted outside the function. When I modified <code>x</code>, R made a copy of <code>x</code> and sorted the <em>copy</em> that belonged to the function so that I didn’t modify a variable that was defined outside of the scope of my function. But what if I didn’t bother with passing x and k. If I don’t pass in the values of x and k, then R will try to find them in my current work space.</p>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb506-1" data-line-number="1"><span class="co"># a horribly defined function that has no parameters</span></a>
<a class="sourceLine" id="cb506-2" data-line-number="2"><span class="co"># but still accesses something called &quot;x&quot;</span></a>
<a class="sourceLine" id="cb506-3" data-line-number="3">trimmed.mean &lt;-<span class="st"> </span><span class="cf">function</span>(){</a>
<a class="sourceLine" id="cb506-4" data-line-number="4">  <span class="kw">browser</span>()</a>
<a class="sourceLine" id="cb506-5" data-line-number="5">  x &lt;-<span class="st"> </span><span class="kw">sort</span>(x)              <span class="co"># Access global x, sort and save in local environment</span></a>
<a class="sourceLine" id="cb506-6" data-line-number="6">  n &lt;-<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb506-7" data-line-number="7">  <span class="cf">if</span>( k <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>){               <span class="co"># Accessing the Global k</span></a>
<a class="sourceLine" id="cb506-8" data-line-number="8">    x &lt;-<span class="st"> </span>x[<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span><span class="op">*</span>(<span class="dv">1</span><span class="op">:</span>k), <span class="dv">-1</span><span class="op">*</span>((n<span class="op">-</span>k<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n))]</a>
<a class="sourceLine" id="cb506-9" data-line-number="9">  }</a>
<a class="sourceLine" id="cb506-10" data-line-number="10">  tm &lt;-<span class="st"> </span><span class="kw">sum</span>(x)<span class="op">/</span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb506-11" data-line-number="11">  <span class="kw">return</span>( tm )</a>
<a class="sourceLine" id="cb506-12" data-line-number="12">} </a>
<a class="sourceLine" id="cb506-13" data-line-number="13"></a>
<a class="sourceLine" id="cb506-14" data-line-number="14">x &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="dv">50</span>, <span class="dv">10</span><span class="op">:</span><span class="dv">1</span> )    <span class="co"># data to trim</span></a>
<a class="sourceLine" id="cb506-15" data-line-number="15">k &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb506-16" data-line-number="16"></a>
<a class="sourceLine" id="cb506-17" data-line-number="17"><span class="kw">trimmed.mean</span>()  <span class="co"># amazingly this still works</span></a></code></pre></div>
<pre><code>## Called from: trimmed.mean()
## debug at &lt;text&gt;#5: x &lt;- sort(x)
## debug at &lt;text&gt;#6: n &lt;- length(x)
## debug at &lt;text&gt;#7: if (k &gt; 0) {
##     x &lt;- x[c(-1 * (1:k), -1 * ((n - k + 1):n))]
## }
## debug at &lt;text&gt;#8: x &lt;- x[c(-1 * (1:k), -1 * ((n - k + 1):n))]
## debug at &lt;text&gt;#10: tm &lt;- sum(x)/length(x)
## debug at &lt;text&gt;#11: return(tm)</code></pre>
<pre><code>## [1] 6</code></pre>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb509-1" data-line-number="1"><span class="co"># but what if k wasn&#39;t defined?</span></a>
<a class="sourceLine" id="cb509-2" data-line-number="2"><span class="kw">rm</span>(k)           <span class="co"># remove k </span></a>
<a class="sourceLine" id="cb509-3" data-line-number="3"><span class="kw">trimmed.mean</span>()  <span class="co"># now the function can&#39;t find anything named k and throws and error.</span></a></code></pre></div>
<pre><code>## Called from: trimmed.mean()
## debug at &lt;text&gt;#5: x &lt;- sort(x)
## debug at &lt;text&gt;#6: n &lt;- length(x)
## debug at &lt;text&gt;#7: if (k &gt; 0) {
##     x &lt;- x[c(-1 * (1:k), -1 * ((n - k + 1):n))]
## }</code></pre>
<pre><code>## Error in trimmed.mean(): object &#39;k&#39; not found</code></pre>
<p>So if I forget to pass some variable into a function, but it happens to be defined outside the function, R will find it. It is not good practice to rely on that because how do I take the trimmed mean of a vector named <code>z</code>? Worse yet, what if the variable <code>x</code> changes between runs of your function? What should be consistently giving the same result keeps changing. This is especially insidious when you have defined most of the arguments the function uses, but missed one. Your function happily goes to the next higher scope and sometimes finds it.</p>
<p>When executing a function, R will have access to all the variables defined in the function, all the variables defined in the function that called your function and so on until the base work space. However, you should never let your function refer to something that is not either created in your function or passed in via a parameter.</p>
</div>
<div id="exercises-10" class="section level2">
<h2><span class="header-section-number">10.7</span> Exercises</h2>
<ol style="list-style-type: decimal">
<li>Write a function that calculates the density function of a Uniform continuous variable on the interval <span class="math inline">\(\left(a,b\right)\)</span>. The function is defined as
<span class="math display">\[f\left(x\right)=\begin{cases}
 \frac{1}{b-a} &amp; \;\;\;\textrm{if }a\le x\le b\\
 0 &amp; \;\;\;\textrm{otherwise}
 \end{cases}\]</span>
which looks like this
<img src="21_Functions_files/figure-html/unnamed-chunk-23-1.png" width="672" />
We want to write a function <code>duniform(x, a, b)</code> that takes an arbitrary value of <code>x</code> and parameters a and b and return the appropriate height of the density function. For various values of <code>x</code>, <code>a</code>, and <code>b</code>, demonstrate that your function returns the correct density value.
<ol style="list-style-type: lower-alpha">
<li>Write your function without regard for it working with vectors of data. Demonstrate that it works by calling the function three times, once where x&lt; a, once where a &lt; x and x &lt; b, and finally once where b &lt; x.</li>
<li><p>Next we force our function to work correctly for a vector of <code>x</code> values. Modify your function in part (a) so that the core logic is inside a <code>for</code> statement and the loop moves through each element of <code>x</code> in succession. Your function should look something like this:</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb512-1" data-line-number="1">duniform &lt;-<span class="st"> </span><span class="cf">function</span>(x, a, b){</a>
<a class="sourceLine" id="cb512-2" data-line-number="2">  output &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb512-3" data-line-number="3">  <span class="cf">for</span>( i <span class="cf">in</span> ??? ){  <span class="co"># Set the for loop to look at each element of x</span></a>
<a class="sourceLine" id="cb512-4" data-line-number="4">    <span class="cf">if</span>( x[i] ??? ){  <span class="co"># What should this logical expression be?</span></a>
<a class="sourceLine" id="cb512-5" data-line-number="5">      <span class="co"># ???  Something ought to be saved in output[i]</span></a>
<a class="sourceLine" id="cb512-6" data-line-number="6">    }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb512-7" data-line-number="7">      <span class="co"># ???  Something else ought to be saved in output[i]</span></a>
<a class="sourceLine" id="cb512-8" data-line-number="8">    }</a>
<a class="sourceLine" id="cb512-9" data-line-number="9">  }</a>
<a class="sourceLine" id="cb512-10" data-line-number="10">  <span class="kw">return</span>(output)</a>
<a class="sourceLine" id="cb512-11" data-line-number="11">}</a></code></pre></div>
<p>Verify that your function works correctly by running the following code:</p>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb513-1" data-line-number="1"><span class="kw">data.frame</span>( <span class="dt">x=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">12</span>, <span class="dt">by=</span>.<span class="dv">001</span>) ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb513-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>( <span class="dt">y =</span> <span class="kw">duniform</span>(x, <span class="dv">4</span>, <span class="dv">8</span>) ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb513-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>( <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y) ) <span class="op">+</span></a>
<a class="sourceLine" id="cb513-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_step</span>()</a></code></pre></div></li>
<li><p>Install the R package <code>microbenchmark</code>. We will use this to discover the average duration your function takes.</p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb514-1" data-line-number="1">microbenchmark<span class="op">::</span><span class="kw">microbenchmark</span>( <span class="kw">duniform</span>( <span class="kw">seq</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">12</span>,<span class="dt">by=</span>.<span class="dv">0001</span>), <span class="dv">4</span>, <span class="dv">8</span>) )</a></code></pre></div>
In particular, look at the median time for evaluation.</li>
<li><p>Instead of using a <code>for</code> loop, it might have been easier to use our standard <code>dplyr::mutate</code> command with an <code>ifelse()</code> command. Rewrite your function to run the <code>dplyr::mutate</code> command with an <code>ifelse()</code> command to produce a new results column and return that results column. Verify that your function works correctly by producing a plot, and also run the <code>microbenchmark()</code>. Which version of your function was easier to write? Which ran faster?</p></li>
</ol></li>
<li><p>I very often want to provide default values to a parameter that I pass to a function. For example, it is so common for me to use the <code>pnorm()</code> and <code>qnorm()</code> functions on the standard normal, that R will automatically use <code>mean=0</code> and <code>sd=1</code> parameters unless you tell R otherwise. To get that behavior, we just set the default parameter values in the definition. When the function is called, the user specified value is used, but if none is specified, the defaults are used. Look at the help page for the functions <code>dunif()</code>, and notice that there are a number of default parameters. For your <code>duniform()</code> function provide default values of <code>0</code> and <code>1</code> for <code>a</code> and <code>b</code>. Demonstrate that your function is appropriately using the given default values.</p></li>
<li><p>A common data processing step is to <em>standardize</em> numeric variables by subtracting the mean and dividing by the standard deviation. Create a function that takes a vector of numerical values and produces an output vector of the standardized values. We will then apply this function to each numeric column in a data frame using the <code>dplyr::mutate_if()</code> command. <em>This is often done in model algorithms that rely on numerical optimization methods to find a solution. By keeping the scales of different predictor covariates the same, the numerical optimization routines generally work better.</em></p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb515-1" data-line-number="1">standardize &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb515-2" data-line-number="2">  <span class="co">## What goes here?</span></a>
<a class="sourceLine" id="cb515-3" data-line-number="3">}</a>
<a class="sourceLine" id="cb515-4" data-line-number="4"></a>
<a class="sourceLine" id="cb515-5" data-line-number="5"><span class="kw">data</span>( <span class="st">&#39;iris&#39;</span> )</a>
<a class="sourceLine" id="cb515-6" data-line-number="6"><span class="co"># Graph the pre-transformed data.</span></a>
<a class="sourceLine" id="cb515-7" data-line-number="7"><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(<span class="dt">x=</span>Sepal.Length, <span class="dt">y=</span>Sepal.Width, <span class="dt">color=</span>Species)) <span class="op">+</span></a>
<a class="sourceLine" id="cb515-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb515-9" data-line-number="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&#39;Pre-Transformation&#39;</span>)</a>
<a class="sourceLine" id="cb515-10" data-line-number="10"></a>
<a class="sourceLine" id="cb515-11" data-line-number="11"><span class="co"># Standardize the numeric columns</span></a>
<a class="sourceLine" id="cb515-12" data-line-number="12">iris.z &lt;-<span class="st"> </span>iris <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate_if</span>( is.numeric, standardize )</a>
<a class="sourceLine" id="cb515-13" data-line-number="13"></a>
<a class="sourceLine" id="cb515-14" data-line-number="14"><span class="co"># Graph the post-transformed data.</span></a>
<a class="sourceLine" id="cb515-15" data-line-number="15"><span class="kw">ggplot</span>(iris.z, <span class="kw">aes</span>(<span class="dt">x=</span>Sepal.Length, <span class="dt">y=</span>Sepal.Width, <span class="dt">color=</span>Species)) <span class="op">+</span></a>
<a class="sourceLine" id="cb515-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb515-17" data-line-number="17"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&#39;Post-Transformation&#39;</span>)</a></code></pre></div></li>
<li><p>In this example, we’ll write a function that will output the first n terms in the child’s game <em>Fizz Buzz</em>. The goal is to count as high as you can, but for any number evenly divisible by 3, substitute “Fizz” and any number evenly divisible by 5, substitute “Buzz”, and if it is divisible by both, substitute “Fizz Buzz”. I recently saw a wonderful YouTube <a href="https://www.youtube.com/watch?v=QPZ0pIK_wsc">video</a> describing how to write an appropriate loop to do this in JavaScript, but it should be easy enough to interpret what to do in R. <em>Hint: The <code>paste()</code> function will squish strings together, the remainder operator is <code>%%</code> where it is used as <code>9 %% 3 = 0</code>.</em></p></li>
</ol>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb516-1" data-line-number="1"><span class="co"># Because I added this problem late in the Fall 2019 semester, I just want you to </span></a>
<a class="sourceLine" id="cb516-2" data-line-number="2"><span class="co"># watch the videa about how to think about writing a for loop.</span></a>
<a class="sourceLine" id="cb516-3" data-line-number="3"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb516-4" data-line-number="4">FizzBuzz &lt;-<span class="st"> </span><span class="cf">function</span>(n){</a>
<a class="sourceLine" id="cb516-5" data-line-number="5">  output &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">i =</span> <span class="dv">1</span><span class="op">:</span>n, <span class="dt">result=</span><span class="st">&#39;&#39;</span>)</a>
<a class="sourceLine" id="cb516-6" data-line-number="6">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb516-7" data-line-number="7">    <span class="cf">if</span>( i <span class="op">%%</span><span class="st"> </span><span class="dv">3</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span> ){</a>
<a class="sourceLine" id="cb516-8" data-line-number="8">      output[i,<span class="st">&#39;result&#39;</span>] &lt;-<span class="st"> </span><span class="kw">paste</span>(output[i,<span class="st">&#39;result&#39;</span>], <span class="st">&#39;Fizz&#39;</span>)</a>
<a class="sourceLine" id="cb516-9" data-line-number="9">    }</a>
<a class="sourceLine" id="cb516-10" data-line-number="10">    <span class="cf">if</span>( i <span class="op">%%</span><span class="st"> </span><span class="dv">5</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb516-11" data-line-number="11">      output[i,<span class="st">&#39;result&#39;</span>] &lt;-<span class="st"> </span><span class="kw">paste</span>(output[i,<span class="st">&#39;result&#39;</span>], <span class="st">&#39;Buzz&#39;</span>)</a>
<a class="sourceLine" id="cb516-12" data-line-number="12">    }</a>
<a class="sourceLine" id="cb516-13" data-line-number="13">  }</a>
<a class="sourceLine" id="cb516-14" data-line-number="14">  output &lt;-<span class="st"> </span>output <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb516-15" data-line-number="15"><span class="st">    </span><span class="kw">mutate</span>( <span class="dt">result =</span> <span class="kw">ifelse</span>(result <span class="op">==</span><span class="st"> &#39;&#39;</span>, i, result) ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb516-16" data-line-number="16"><span class="st">    </span><span class="kw">mutate</span>( <span class="dt">result =</span> <span class="kw">str_trim</span>(result) )  <span class="co"># Remove the spaces at the beginning</span></a>
<a class="sourceLine" id="cb516-17" data-line-number="17">  <span class="kw">return</span>(output)</a>
<a class="sourceLine" id="cb516-18" data-line-number="18">}</a>
<a class="sourceLine" id="cb516-19" data-line-number="19"><span class="kw">FizzBuzz</span>(<span class="dv">15</span>)</a></code></pre></div>
<pre><code>## # A tibble: 15 x 2
##        i result   
##    &lt;int&gt; &lt;chr&gt;    
##  1     1 1        
##  2     2 2        
##  3     3 Fizz     
##  4     4 4        
##  5     5 Buzz     
##  6     6 Fizz     
##  7     7 7        
##  8     8 8        
##  9     9 Fizz     
## 10    10 Buzz     
## 11    11 11       
## 12    12 Fizz     
## 13    13 13       
## 14    14 14       
## 15    15 Fizz Buzz</code></pre>
<ol start="5" style="list-style-type: decimal">
<li><p>A common statistical requirement is to create bootstrap confidence intervals for a model statistic. This is done by repeatedly re-sampling with replacement from our original sample data, running the analysis for each re-sample, and then saving the statistic of interest. Below is a function <code>boot.lm</code> that bootstraps the linear model using case re-sampling.</p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb518-1" data-line-number="1"><span class="co">#&#39; Calculate bootstrap CI for an lm object</span></a>
<a class="sourceLine" id="cb518-2" data-line-number="2"><span class="co">#&#39; </span></a>
<a class="sourceLine" id="cb518-3" data-line-number="3"><span class="co">#&#39; @param model</span></a>
<a class="sourceLine" id="cb518-4" data-line-number="4"><span class="co">#&#39; @param N</span></a>
<a class="sourceLine" id="cb518-5" data-line-number="5">boot.lm &lt;-<span class="st"> </span><span class="cf">function</span>(model, <span class="dt">N=</span><span class="dv">1000</span>){</a>
<a class="sourceLine" id="cb518-6" data-line-number="6">  data    &lt;-<span class="st"> </span>model<span class="op">$</span>model  <span class="co"># Extract the original data</span></a>
<a class="sourceLine" id="cb518-7" data-line-number="7">  formula &lt;-<span class="st"> </span>model<span class="op">$</span>terms  <span class="co"># and model formula used</span></a>
<a class="sourceLine" id="cb518-8" data-line-number="8"></a>
<a class="sourceLine" id="cb518-9" data-line-number="9">  <span class="co"># Start the output data frame with the full sample statistic</span></a>
<a class="sourceLine" id="cb518-10" data-line-number="10">  output &lt;-<span class="st"> </span>broom<span class="op">::</span><span class="kw">tidy</span>(model) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb518-11" data-line-number="11"><span class="st">    </span><span class="kw">select</span>(term, estimate) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb518-12" data-line-number="12"><span class="st">    </span><span class="kw">spread</span>(term, estimate)</a>
<a class="sourceLine" id="cb518-13" data-line-number="13"></a>
<a class="sourceLine" id="cb518-14" data-line-number="14">  <span class="cf">for</span>( i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N ){</a>
<a class="sourceLine" id="cb518-15" data-line-number="15">    data &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_frac</span>( <span class="dt">replace=</span><span class="ot">TRUE</span> )</a>
<a class="sourceLine" id="cb518-16" data-line-number="16">    model.boot &lt;-<span class="st"> </span><span class="kw">lm</span>( formula, <span class="dt">data=</span>data)</a>
<a class="sourceLine" id="cb518-17" data-line-number="17">    coefs &lt;-<span class="st"> </span>broom<span class="op">::</span><span class="kw">tidy</span>(model.boot) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb518-18" data-line-number="18"><span class="st">      </span><span class="kw">select</span>(term, estimate) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb518-19" data-line-number="19"><span class="st">      </span><span class="kw">spread</span>(term, estimate)</a>
<a class="sourceLine" id="cb518-20" data-line-number="20">    output &lt;-<span class="st"> </span>output <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbind</span>( coefs )</a>
<a class="sourceLine" id="cb518-21" data-line-number="21">  }  </a>
<a class="sourceLine" id="cb518-22" data-line-number="22"></a>
<a class="sourceLine" id="cb518-23" data-line-number="23">  <span class="kw">return</span>(output)</a>
<a class="sourceLine" id="cb518-24" data-line-number="24">}</a>
<a class="sourceLine" id="cb518-25" data-line-number="25"></a>
<a class="sourceLine" id="cb518-26" data-line-number="26"><span class="co"># Run the function on a model</span></a>
<a class="sourceLine" id="cb518-27" data-line-number="27">m &lt;-<span class="st"> </span><span class="kw">lm</span>( Volume <span class="op">~</span><span class="st"> </span>Girth, <span class="dt">data=</span>trees )</a>
<a class="sourceLine" id="cb518-28" data-line-number="28">boot.dist &lt;-<span class="st"> </span><span class="kw">boot.lm</span>(m)</a>
<a class="sourceLine" id="cb518-29" data-line-number="29"></a>
<a class="sourceLine" id="cb518-30" data-line-number="30"><span class="co"># If boot.lm() works, then the following produces a nice graph</span></a>
<a class="sourceLine" id="cb518-31" data-line-number="31">boot.dist <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(<span class="st">&#39;term&#39;</span>,<span class="st">&#39;estimate&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb518-32" data-line-number="32"><span class="st">  </span><span class="kw">ggplot</span>( <span class="kw">aes</span>(<span class="dt">x=</span>estimate) ) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb518-33" data-line-number="33"><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb518-34" data-line-number="34"><span class="st">  </span><span class="kw">facet_grid</span>(.<span class="op">~</span>term, <span class="dt">scales=</span><span class="st">&#39;free&#39;</span>)</a></code></pre></div>
<p>This code does not correctly calculate a bootstrap sample for the model coefficients. Figure out where the mistake is. <em>Hint: Even if you haven’t studied the bootstrap, my description above gives enough information about the bootstrap algorithm to figure this out.</em></p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="9-importing-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="11-string-manipulation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"],
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/dereksonderegger/444/raw/master/21_Functions.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
