<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Statistical Models | STA 444/5 - Introductory Data Science using R</title>
  <meta name="description" content="Chapter 5 Statistical Models | STA 444/5 - Introductory Data Science using R" />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Statistical Models | STA 444/5 - Introductory Data Science using R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/Cover1.png" />
  
  <meta name="github-repo" content="dereksonderegger/444" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Statistical Models | STA 444/5 - Introductory Data Science using R" />
  
  
  <meta name="twitter:image" content="images/Cover1.png" />

<meta name="author" content="Derek L. Sonderegger" />


<meta name="date" content="2019-09-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="4-data-wrangling.html">
<link rel="next" href="6-flow-control.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-resources"><i class="fa fa-check"></i>Other Resources</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="part"><span><b>Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="1-familiarization.html"><a href="1-familiarization.html"><i class="fa fa-check"></i><b>1</b> Familiarization</a><ul>
<li class="chapter" data-level="1.1" data-path="1-familiarization.html"><a href="1-familiarization.html#r-file-types"><i class="fa fa-check"></i><b>1.1</b> R file Types</a><ul>
<li class="chapter" data-level="1.1.1" data-path="1-familiarization.html"><a href="1-familiarization.html#r-scripts-.r-files"><i class="fa fa-check"></i><b>1.1.1</b> R Scripts (.R files)</a></li>
<li class="chapter" data-level="1.1.2" data-path="1-familiarization.html"><a href="1-familiarization.html#r-markdown-.rmd-files"><i class="fa fa-check"></i><b>1.1.2</b> R Markdown (.Rmd files)</a></li>
<li class="chapter" data-level="1.1.3" data-path="1-familiarization.html"><a href="1-familiarization.html#r-notebooks-.rmd-files"><i class="fa fa-check"></i><b>1.1.3</b> R Notebooks (.Rmd files)</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="1-familiarization.html"><a href="1-familiarization.html#r-as-a-simple-calculator"><i class="fa fa-check"></i><b>1.2</b> R as a simple calculator</a></li>
<li class="chapter" data-level="1.3" data-path="1-familiarization.html"><a href="1-familiarization.html#assignment"><i class="fa fa-check"></i><b>1.3</b> Assignment</a></li>
<li class="chapter" data-level="1.4" data-path="1-familiarization.html"><a href="1-familiarization.html#vectors"><i class="fa fa-check"></i><b>1.4</b> Vectors</a></li>
<li class="chapter" data-level="1.5" data-path="1-familiarization.html"><a href="1-familiarization.html#packages"><i class="fa fa-check"></i><b>1.5</b> Packages</a></li>
<li class="chapter" data-level="1.6" data-path="1-familiarization.html"><a href="1-familiarization.html#finding-help"><i class="fa fa-check"></i><b>1.6</b> Finding Help</a><ul>
<li class="chapter" data-level="1.6.1" data-path="1-familiarization.html"><a href="1-familiarization.html#how-does-this-function-work"><i class="fa fa-check"></i><b>1.6.1</b> How does this function work?</a></li>
<li class="chapter" data-level="1.6.2" data-path="1-familiarization.html"><a href="1-familiarization.html#how-does-this-package-work"><i class="fa fa-check"></i><b>1.6.2</b> How does this package work?</a></li>
<li class="chapter" data-level="1.6.3" data-path="1-familiarization.html"><a href="1-familiarization.html#how-do-i-do-xxx"><i class="fa fa-check"></i><b>1.6.3</b> How do I do XXX?</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="1-familiarization.html"><a href="1-familiarization.html#exercises"><i class="fa fa-check"></i><b>1.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-data-frames.html"><a href="2-data-frames.html"><i class="fa fa-check"></i><b>2</b> Data Frames</a><ul>
<li class="chapter" data-level="2.1" data-path="2-data-frames.html"><a href="2-data-frames.html#introduction-to-importing-data"><i class="fa fa-check"></i><b>2.1</b> Introduction to Importing Data</a><ul>
<li class="chapter" data-level="2.1.1" data-path="2-data-frames.html"><a href="2-data-frames.html#from-a-package"><i class="fa fa-check"></i><b>2.1.1</b> From a Package</a></li>
<li class="chapter" data-level="2.1.2" data-path="2-data-frames.html"><a href="2-data-frames.html#import-from-.csv-or-.xls-files"><i class="fa fa-check"></i><b>2.1.2</b> Import from <code>.csv</code> or <code>.xls</code> files</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-data-frames.html"><a href="2-data-frames.html#data-types"><i class="fa fa-check"></i><b>2.2</b> Data Types</a></li>
<li class="chapter" data-level="2.3" data-path="2-data-frames.html"><a href="2-data-frames.html#basic-manipulation"><i class="fa fa-check"></i><b>2.3</b> Basic Manipulation</a></li>
<li class="chapter" data-level="2.4" data-path="2-data-frames.html"><a href="2-data-frames.html#exercises-1"><i class="fa fa-check"></i><b>2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-graphing.html"><a href="3-graphing.html"><i class="fa fa-check"></i><b>3</b> Graphing</a><ul>
<li class="chapter" data-level="3.1" data-path="3-graphing.html"><a href="3-graphing.html#basic-graphs"><i class="fa fa-check"></i><b>3.1</b> Basic Graphs</a><ul>
<li class="chapter" data-level="3.1.1" data-path="3-graphing.html"><a href="3-graphing.html#scatterplots"><i class="fa fa-check"></i><b>3.1.1</b> Scatterplots</a></li>
<li class="chapter" data-level="3.1.2" data-path="3-graphing.html"><a href="3-graphing.html#box-plots"><i class="fa fa-check"></i><b>3.1.2</b> Box Plots</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="3-graphing.html"><a href="3-graphing.html#title-axis-labels"><i class="fa fa-check"></i><b>3.2</b> Title &amp; Axis Labels</a></li>
<li class="chapter" data-level="3.3" data-path="3-graphing.html"><a href="3-graphing.html#annotation"><i class="fa fa-check"></i><b>3.3</b> Annotation</a><ul>
<li class="chapter" data-level="3.3.1" data-path="3-graphing.html"><a href="3-graphing.html#using-a-data.frame"><i class="fa fa-check"></i><b>3.3.1</b> Using a <code>data.frame</code></a></li>
<li class="chapter" data-level="3.3.2" data-path="3-graphing.html"><a href="3-graphing.html#setting-attributes-in-line"><i class="fa fa-check"></i><b>3.3.2</b> Setting attributes in-line</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="3-graphing.html"><a href="3-graphing.html#faceting"><i class="fa fa-check"></i><b>3.4</b> Faceting</a></li>
<li class="chapter" data-level="3.5" data-path="3-graphing.html"><a href="3-graphing.html#exercises-2"><i class="fa fa-check"></i><b>3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-data-wrangling.html"><a href="4-data-wrangling.html"><i class="fa fa-check"></i><b>4</b> Data Wrangling</a><ul>
<li class="chapter" data-level="4.1" data-path="4-data-wrangling.html"><a href="4-data-wrangling.html#verbs"><i class="fa fa-check"></i><b>4.1</b> Verbs</a><ul>
<li class="chapter" data-level="4.1.1" data-path="4-data-wrangling.html"><a href="4-data-wrangling.html#subsetting"><i class="fa fa-check"></i><b>4.1.1</b> Subsetting</a></li>
<li class="chapter" data-level="4.1.2" data-path="4-data-wrangling.html"><a href="4-data-wrangling.html#arrange"><i class="fa fa-check"></i><b>4.1.2</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="4.1.3" data-path="4-data-wrangling.html"><a href="4-data-wrangling.html#mutate"><i class="fa fa-check"></i><b>4.1.3</b> mutate()</a></li>
<li class="chapter" data-level="4.1.4" data-path="4-data-wrangling.html"><a href="4-data-wrangling.html#summarise"><i class="fa fa-check"></i><b>4.1.4</b> summarise()</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="4-data-wrangling.html"><a href="4-data-wrangling.html#split-apply-combine"><i class="fa fa-check"></i><b>4.2</b> Split, apply, combine</a></li>
<li class="chapter" data-level="4.3" data-path="4-data-wrangling.html"><a href="4-data-wrangling.html#exercises-3"><i class="fa fa-check"></i><b>4.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-statistical-models.html"><a href="5-statistical-models.html"><i class="fa fa-check"></i><b>5</b> Statistical Models</a><ul>
<li class="chapter" data-level="5.1" data-path="5-statistical-models.html"><a href="5-statistical-models.html#formula-notation"><i class="fa fa-check"></i><b>5.1</b> Formula Notation</a></li>
<li class="chapter" data-level="5.2" data-path="5-statistical-models.html"><a href="5-statistical-models.html#basic-models"><i class="fa fa-check"></i><b>5.2</b> Basic Models</a><ul>
<li class="chapter" data-level="5.2.1" data-path="5-statistical-models.html"><a href="5-statistical-models.html#t-tests"><i class="fa fa-check"></i><b>5.2.1</b> t-tests</a></li>
<li class="chapter" data-level="5.2.2" data-path="5-statistical-models.html"><a href="5-statistical-models.html#lm-objects"><i class="fa fa-check"></i><b>5.2.2</b> lm objects</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="5-statistical-models.html"><a href="5-statistical-models.html#accessor-function"><i class="fa fa-check"></i><b>5.3</b> Accessor function</a></li>
<li class="chapter" data-level="5.4" data-path="5-statistical-models.html"><a href="5-statistical-models.html#exercises-4"><i class="fa fa-check"></i><b>5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-flow-control.html"><a href="6-flow-control.html"><i class="fa fa-check"></i><b>6</b> Flow Control</a><ul>
<li class="chapter" data-level="6.1" data-path="6-flow-control.html"><a href="6-flow-control.html#decision-statements"><i class="fa fa-check"></i><b>6.1</b> Decision statements</a><ul>
<li class="chapter" data-level="6.1.1" data-path="6-flow-control.html"><a href="6-flow-control.html#in-dplyr-wrangling"><i class="fa fa-check"></i><b>6.1.1</b> In dplyr wrangling</a></li>
<li class="chapter" data-level="6.1.2" data-path="6-flow-control.html"><a href="6-flow-control.html#general-if-else"><i class="fa fa-check"></i><b>6.1.2</b> General <code>if else</code></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="6-flow-control.html"><a href="6-flow-control.html#loops"><i class="fa fa-check"></i><b>6.2</b> Loops</a><ul>
<li class="chapter" data-level="6.2.1" data-path="6-flow-control.html"><a href="6-flow-control.html#while-loops"><i class="fa fa-check"></i><b>6.2.1</b> <code>while</code> Loops</a></li>
<li class="chapter" data-level="6.2.2" data-path="6-flow-control.html"><a href="6-flow-control.html#for-loops"><i class="fa fa-check"></i><b>6.2.2</b> <code>for</code> Loops</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="6-flow-control.html"><a href="6-flow-control.html#exercises-5"><i class="fa fa-check"></i><b>6.3</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>Deeper Details</b></span></li>
<li class="chapter" data-level="7" data-path="7-factors.html"><a href="7-factors.html"><i class="fa fa-check"></i><b>7</b> Factors</a><ul>
<li class="chapter" data-level="7.1" data-path="7-factors.html"><a href="7-factors.html#creation-and-structure"><i class="fa fa-check"></i><b>7.1</b> Creation and Structure</a></li>
<li class="chapter" data-level="7.2" data-path="7-factors.html"><a href="7-factors.html#change-labels"><i class="fa fa-check"></i><b>7.2</b> Change Labels</a></li>
<li class="chapter" data-level="7.3" data-path="7-factors.html"><a href="7-factors.html#reorder-levels-1"><i class="fa fa-check"></i><b>7.3</b> Reorder Levels</a></li>
<li class="chapter" data-level="7.4" data-path="7-factors.html"><a href="7-factors.html#add-or-substract-levels"><i class="fa fa-check"></i><b>7.4</b> Add or substract Levels</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-importing-data.html"><a href="8-importing-data.html"><i class="fa fa-check"></i><b>8</b> Importing Data</a><ul>
<li class="chapter" data-level="8.1" data-path="8-importing-data.html"><a href="8-importing-data.html#working-directory"><i class="fa fa-check"></i><b>8.1</b> Working directory</a></li>
<li class="chapter" data-level="8.2" data-path="8-importing-data.html"><a href="8-importing-data.html#comma-separated-data"><i class="fa fa-check"></i><b>8.2</b> Comma Separated Data</a></li>
<li class="chapter" data-level="8.3" data-path="8-importing-data.html"><a href="8-importing-data.html#ms-excel"><i class="fa fa-check"></i><b>8.3</b> MS Excel</a></li>
<li class="chapter" data-level="8.4" data-path="8-importing-data.html"><a href="8-importing-data.html#exercises-6"><i class="fa fa-check"></i><b>8.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-data-manipulation.html"><a href="9-data-manipulation.html"><i class="fa fa-check"></i><b>9</b> Data Manipulation</a><ul>
<li class="chapter" data-level="9.1" data-path="9-data-manipulation.html"><a href="9-data-manipulation.html#classical-functions-for-summarizing-rows-and-columns"><i class="fa fa-check"></i><b>9.1</b> Classical functions for summarizing rows and columns</a><ul>
<li class="chapter" data-level="9.1.1" data-path="9-data-manipulation.html"><a href="9-data-manipulation.html#summary"><i class="fa fa-check"></i><b>9.1.1</b> <code>summary()</code></a></li>
<li class="chapter" data-level="9.1.2" data-path="9-data-manipulation.html"><a href="9-data-manipulation.html#apply"><i class="fa fa-check"></i><b>9.1.2</b> <code>apply()</code></a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="9-data-manipulation.html"><a href="9-data-manipulation.html#package-dplyr"><i class="fa fa-check"></i><b>9.2</b> Package <code>dplyr</code></a><ul>
<li class="chapter" data-level="9.2.1" data-path="9-data-manipulation.html"><a href="9-data-manipulation.html#verbs-1"><i class="fa fa-check"></i><b>9.2.1</b> Verbs</a></li>
<li class="chapter" data-level="9.2.2" data-path="9-data-manipulation.html"><a href="9-data-manipulation.html#split-apply-combine-1"><i class="fa fa-check"></i><b>9.2.2</b> Split, apply, combine</a></li>
<li class="chapter" data-level="9.2.3" data-path="9-data-manipulation.html"><a href="9-data-manipulation.html#chaining-commands-together"><i class="fa fa-check"></i><b>9.2.3</b> Chaining commands together</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="9-data-manipulation.html"><a href="9-data-manipulation.html#exercises-7"><i class="fa fa-check"></i><b>9.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-user-defined-functions.html"><a href="10-user-defined-functions.html"><i class="fa fa-check"></i><b>10</b> User Defined Functions</a><ul>
<li class="chapter" data-level="10.1" data-path="10-user-defined-functions.html"><a href="10-user-defined-functions.html#basic-function-definition"><i class="fa fa-check"></i><b>10.1</b> Basic function definition</a></li>
<li class="chapter" data-level="10.2" data-path="10-user-defined-functions.html"><a href="10-user-defined-functions.html#parameter-defaults"><i class="fa fa-check"></i><b>10.2</b> Parameter Defaults</a></li>
<li class="chapter" data-level="10.3" data-path="10-user-defined-functions.html"><a href="10-user-defined-functions.html#ellipses"><i class="fa fa-check"></i><b>10.3</b> Ellipses</a></li>
<li class="chapter" data-level="10.4" data-path="10-user-defined-functions.html"><a href="10-user-defined-functions.html#function-overloading"><i class="fa fa-check"></i><b>10.4</b> Function Overloading</a></li>
<li class="chapter" data-level="10.5" data-path="10-user-defined-functions.html"><a href="10-user-defined-functions.html#scope"><i class="fa fa-check"></i><b>10.5</b> Scope</a></li>
<li class="chapter" data-level="10.6" data-path="10-user-defined-functions.html"><a href="10-user-defined-functions.html#exercises-8"><i class="fa fa-check"></i><b>10.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html"><i class="fa fa-check"></i><b>11</b> String Manipulation</a><ul>
<li class="chapter" data-level="11.1" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#base-function"><i class="fa fa-check"></i><b>11.1</b> Base function</a></li>
<li class="chapter" data-level="11.2" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#package-stringr-basic-operations"><i class="fa fa-check"></i><b>11.2</b> Package <code>stringr</code>: basic operations</a><ul>
<li class="chapter" data-level="11.2.1" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#concatenating-with-str_c-or-str_join"><i class="fa fa-check"></i><b>11.2.1</b> Concatenating with <code>str_c()</code> or <code>str_join()</code></a></li>
<li class="chapter" data-level="11.2.2" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#calculating-string-length-with-str_length"><i class="fa fa-check"></i><b>11.2.2</b> Calculating string length with <code>str_length()</code></a></li>
<li class="chapter" data-level="11.2.3" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#extracting-substrings-with-str_sub"><i class="fa fa-check"></i><b>11.2.3</b> Extracting substrings with <code>str_sub()</code></a></li>
<li class="chapter" data-level="11.2.4" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#pad-a-string-with-str_pad"><i class="fa fa-check"></i><b>11.2.4</b> Pad a string with <code>str_pad()</code></a></li>
<li class="chapter" data-level="11.2.5" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#trim-a-string-with-str_trim"><i class="fa fa-check"></i><b>11.2.5</b> Trim a string with <code>str_trim()</code></a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#package-stringr-pattern-matching"><i class="fa fa-check"></i><b>11.3</b> Package <code>stringr</code>: Pattern Matching</a><ul>
<li class="chapter" data-level="11.3.1" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#detecting-a-pattern-using-str_detect"><i class="fa fa-check"></i><b>11.3.1</b> Detecting a pattern using str_detect()</a></li>
<li class="chapter" data-level="11.3.2" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#locating-a-pattern-using-str_locate"><i class="fa fa-check"></i><b>11.3.2</b> Locating a pattern using str_locate()</a></li>
<li class="chapter" data-level="11.3.3" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#replacing-substrings-using-str_replace"><i class="fa fa-check"></i><b>11.3.3</b> Replacing substrings using <code>str_replace()</code></a></li>
<li class="chapter" data-level="11.3.4" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#splitting-into-substrings-using-str_split"><i class="fa fa-check"></i><b>11.3.4</b> Splitting into substrings using <code>str_split()</code></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#regular-expressions"><i class="fa fa-check"></i><b>11.4</b> Regular Expressions</a></li>
<li class="chapter" data-level="11.5" data-path="11-string-manipulation.html"><a href="11-string-manipulation.html#exercises-9"><i class="fa fa-check"></i><b>11.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="12-dates-and-times.html"><a href="12-dates-and-times.html"><i class="fa fa-check"></i><b>12</b> Dates and Times</a><ul>
<li class="chapter" data-level="12.1" data-path="12-dates-and-times.html"><a href="12-dates-and-times.html#creating-date-and-time-objects"><i class="fa fa-check"></i><b>12.1</b> Creating Date and Time objects</a></li>
<li class="chapter" data-level="12.2" data-path="12-dates-and-times.html"><a href="12-dates-and-times.html#extracting-information"><i class="fa fa-check"></i><b>12.2</b> Extracting information</a></li>
<li class="chapter" data-level="12.3" data-path="12-dates-and-times.html"><a href="12-dates-and-times.html#arithmetic-on-dates"><i class="fa fa-check"></i><b>12.3</b> Arithmetic on Dates</a></li>
<li class="chapter" data-level="12.4" data-path="12-dates-and-times.html"><a href="12-dates-and-times.html#exercises-10"><i class="fa fa-check"></i><b>12.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="13-speeding-up-r.html"><a href="13-speeding-up-r.html"><i class="fa fa-check"></i><b>13</b> Speeding up R</a><ul>
<li class="chapter" data-level="13.1" data-path="13-speeding-up-r.html"><a href="13-speeding-up-r.html#faster-for-loops"><i class="fa fa-check"></i><b>13.1</b> Faster for loops?</a></li>
<li class="chapter" data-level="13.2" data-path="13-speeding-up-r.html"><a href="13-speeding-up-r.html#vectorizing-loops"><i class="fa fa-check"></i><b>13.2</b> Vectorizing loops</a></li>
<li class="chapter" data-level="13.3" data-path="13-speeding-up-r.html"><a href="13-speeding-up-r.html#parallel-processing"><i class="fa fa-check"></i><b>13.3</b> Parallel Processing</a></li>
<li class="chapter" data-level="13.4" data-path="13-speeding-up-r.html"><a href="13-speeding-up-r.html#parallelizing-for-loops"><i class="fa fa-check"></i><b>13.4</b> Parallelizing for loops</a></li>
<li class="chapter" data-level="13.5" data-path="13-speeding-up-r.html"><a href="13-speeding-up-r.html#parallel-aware-functions"><i class="fa fa-check"></i><b>13.5</b> Parallel Aware Functions</a><ul>
<li class="chapter" data-level="13.5.1" data-path="13-speeding-up-r.html"><a href="13-speeding-up-r.html#bootboot"><i class="fa fa-check"></i><b>13.5.1</b> <code>boot::boot</code></a></li>
<li class="chapter" data-level="13.5.2" data-path="13-speeding-up-r.html"><a href="13-speeding-up-r.html#carettrain"><i class="fa fa-check"></i><b>13.5.2</b> <code>caret::train</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="14-rmarkdown-tricks.html"><a href="14-rmarkdown-tricks.html"><i class="fa fa-check"></i><b>14</b> Rmarkdown Tricks</a><ul>
<li class="chapter" data-level="14.1" data-path="14-rmarkdown-tricks.html"><a href="14-rmarkdown-tricks.html#mathematical-expressions"><i class="fa fa-check"></i><b>14.1</b> Mathematical expressions</a></li>
<li class="chapter" data-level="14.2" data-path="14-rmarkdown-tricks.html"><a href="14-rmarkdown-tricks.html#tables"><i class="fa fa-check"></i><b>14.2</b> Tables</a></li>
<li class="chapter" data-level="14.3" data-path="14-rmarkdown-tricks.html"><a href="14-rmarkdown-tricks.html#girth-height-volume"><i class="fa fa-check"></i><b>14.3</b> Girth Height Volume</a></li>
<li class="chapter" data-level="14.4" data-path="14-rmarkdown-tricks.html"><a href="14-rmarkdown-tricks.html#section"><i class="fa fa-check"></i><b>14.4</b> 1 8.3 70 10.3</a></li>
<li class="chapter" data-level="14.5" data-path="14-rmarkdown-tricks.html"><a href="14-rmarkdown-tricks.html#section-1"><i class="fa fa-check"></i><b>14.5</b> 2 8.6 65 10.3</a></li>
<li class="chapter" data-level="14.6" data-path="14-rmarkdown-tricks.html"><a href="14-rmarkdown-tricks.html#section-2"><i class="fa fa-check"></i><b>14.6</b> 3 8.8 63 10.2</a></li>
<li class="chapter" data-level="14.7" data-path="14-rmarkdown-tricks.html"><a href="14-rmarkdown-tricks.html#section-3"><i class="fa fa-check"></i><b>14.7</b> 4 10.5 72 16.4</a><ul>
<li class="chapter" data-level="14.7.1" data-path="14-rmarkdown-tricks.html"><a href="14-rmarkdown-tricks.html#simple-tables"><i class="fa fa-check"></i><b>14.7.1</b> Simple Tables</a></li>
<li class="chapter" data-level="14.7.2" data-path="14-rmarkdown-tricks.html"><a href="14-rmarkdown-tricks.html#grid-tables"><i class="fa fa-check"></i><b>14.7.2</b> Grid Tables</a></li>
<li class="chapter" data-level="14.7.3" data-path="14-rmarkdown-tricks.html"><a href="14-rmarkdown-tricks.html#pipe-tables"><i class="fa fa-check"></i><b>14.7.3</b> Pipe Tables</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="14-rmarkdown-tricks.html"><a href="14-rmarkdown-tricks.html#r-functions-to-produce-table-code."><i class="fa fa-check"></i><b>14.8</b> R functions to produce table code.</a><ul>
<li class="chapter" data-level="14.8.1" data-path="14-rmarkdown-tricks.html"><a href="14-rmarkdown-tricks.html#knitrkable"><i class="fa fa-check"></i><b>14.8.1</b> <code>knitr::kable</code></a></li>
<li class="chapter" data-level="14.8.2" data-path="14-rmarkdown-tricks.html"><a href="14-rmarkdown-tricks.html#package-pander"><i class="fa fa-check"></i><b>14.8.2</b> Package <code>pander</code></a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STA 444/5 - Introductory Data Science using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistical-models" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Statistical Models</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(tidyverse, <span class="dt">quietly =</span> <span class="ot">TRUE</span>)   <span class="co"># loading ggplot2 and dplyr</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">options</span>(<span class="dt">tibble.width =</span> <span class="ot">Inf</span>)   <span class="co"># Print all the columns of a tibble (data.frame)</span></a></code></pre></div>
<p>While R is a full programming language, it was first developed by statisticians for statisticians. There are several functions to do common statistical tests but because those functions were developed early in R’s history, there is some inconsistency in how those functions work. There have been some attempts to standardize modeling object interfaces, but there were always be a little weirdness.</p>
<div id="formula-notation" class="section level2">
<h2><span class="header-section-number">5.1</span> Formula Notation</h2>
<p>Most statistical modeling functions rely on a formula based interface. The primary purpose is to provide a consistent way to designate which columns in a data frame are the response variable and which are the explanatory variables. In particular the notation is</p>
<p><span class="math display">\[\underbrace{y}_{\textrm{LHS response}} \;\;\; 
\underbrace{\sim}_{\textrm{is a function of}} \;\;\; 
\underbrace{x}_{\textrm{RHS explanatory}}\]</span></p>
<p>Mathematicians often refer to these terms as the <em>Left Hand Side</em> (LHS) and <em>Right Hand Side</em> (RHS). The LHS is always the response and the RHS contains the explanatory variables.</p>
<p>In R, the LHS is usually just a single variable in the data. However the RHS can contain multiple variables and in complicated relationships.</p>
<table>
<colgroup>
<col width="36%" />
<col width="63%" />
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Right Hand Side Terms</strong></td>
<td>Meaning</td>
</tr>
<tr class="even">
<td><code>x1 + x2</code></td>
<td>Both <code>x1</code> and <code>x2</code> are additive explanatory variables.
In this format, we are adding only the <em>main effects</em>
of the <code>x1</code> and <code>x2</code> variables.</td>
</tr>
<tr class="odd">
<td><code>x1:x2</code></td>
<td>This is the interaction term between <code>x1</code> and <code>x2</code></td>
</tr>
<tr class="even">
<td><code>x1 * x2</code></td>
<td>Because whenever we add an interaction term to a
model, we want to also have the main effects. So this
is a short cut for adding the main effect of <code>x1</code> and
<code>x2</code> and also the interaction term <code>x1:x2</code>.</td>
</tr>
<tr class="odd">
<td><code>(x1 + x2 + x3)^2</code></td>
<td>This is the main effects of <code>x1</code>, <code>x2</code>, and <code>x3</code> and
also all of the second order interactions.</td>
</tr>
<tr class="even">
<td><code>poly(x, degree=2)</code></td>
<td>This fits the degree 2 polynomial. When fit like this,
R produces an orthogonal basis for the polynomial,
which is more computationally stable, but won’t be
appropiate for interpreting the polynomial
coefficients.</td>
</tr>
<tr class="odd">
<td><code>poly(x, degree=2, raw=TRUE)</code></td>
<td>This fits the degree 2 polynomial using
<span class="math inline">\(\beta_0 + \beta_1 x + \beta_2 x^2\)</span> and the polynomial
polynomial coefficients are suitable for
interpretation.</td>
</tr>
<tr class="even">
<td><code>I( x^2 )</code></td>
<td><em>Ignore</em> the usual rules for interpreting formulas
and do the mathematical calculation. This is not
necessary for things like <code>sqrt(x)</code> or <code>log(x)</code> but
required if there is a conflict between mathematics
and the formula interpretation.</td>
</tr>
</tbody>
</table>
</div>
<div id="basic-models" class="section level2">
<h2><span class="header-section-number">5.2</span> Basic Models</h2>
<p>The most common statistical models are generally referred to as <em>linear models</em> and the R function for creating a linear model is <code>lm()</code>. This section will introduce how to fit the model to data in a data frame as well as how to fit very specific t-test models.</p>
<div id="t-tests" class="section level3">
<h3><span class="header-section-number">5.2.1</span> t-tests</h3>
<p>There are several varients on T-tests depending on the question of interest, but they all require a continuous response and a categorical explanatory variable with two levels. If there is an obvious pairing between an observation in the first level of the explanatory variable with an observation in the second level, then it is a <em>paired</em> t-test, otherwise it is a <em>two-sample</em> t-test.</p>
<div id="two-sample-t-tests" class="section level4">
<h4><span class="header-section-number">5.2.1.1</span> Two Sample t-tests</h4>
<p>First we’ll import data from the <code>Lock5Data</code> package that gives SAT scores and gender from 343 students in an introductory statistics class. We’ll also recode the <code>GenderCode</code> column to be more descriptive than 0 or 1. We’ll do a t-test to examine if there is evidence that males and females have a different SAT score at the college these data were take.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&#39;GPAGender&#39;</span>, <span class="dt">package=</span><span class="st">&#39;Lock5Data&#39;</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">GPAGender &lt;-<span class="st"> </span>GPAGender <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>( <span class="dt">Gender =</span> <span class="kw">ifelse</span>(GenderCode <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&#39;Male&#39;</span>, <span class="st">&#39;Female&#39;</span>))</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw">ggplot</span>(GPAGender, <span class="kw">aes</span>(<span class="dt">x=</span>Gender, <span class="dt">y=</span>SAT)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="05_Model_Building_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>We’ll use the function <code>t.test()</code> using the formula interface for specifying the response and the explantory variables. The usual practice should be to save the output of the <code>t.test</code> function call (typically as an object named <code>model</code> or <code>model_1</code> or similar). Once the model has been fit, all of the important quantities have been calculated and saved and we just need to ask for them. Unfortunately, the base functions in R don’t make this particularly easy, but the <code>tidymodels</code> group of packages for building statistical models allows us to wrap all of the important information into a data frame with one row. In this case we will use the <code>broom::tidy()</code> function to extract all the important model results information.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">model &lt;-<span class="st"> </span><span class="kw">t.test</span>(SAT <span class="op">~</span><span class="st"> </span>Gender, <span class="dt">data=</span>GPAGender)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw">print</span>(model) <span class="co"># print the summary information to the screen</span></a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  SAT by Gender
## t = -1.4135, df = 323.26, p-value = 0.1585
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -44.382840   7.270083
## sample estimates:
## mean in group Female   mean in group Male 
##             1195.702             1214.258</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">broom<span class="op">::</span><span class="kw">tidy</span>(model) <span class="co"># all that information as a data frame</span></a></code></pre></div>
<pre><code>## # A tibble: 1 x 10
##   estimate estimate1 estimate2 statistic p.value parameter conf.low
##      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1    -18.6     1196.     1214.     -1.41   0.158      323.    -44.4
##   conf.high method                  alternative
##       &lt;dbl&gt; &lt;chr&gt;                   &lt;chr&gt;      
## 1      7.27 Welch Two Sample t-test two.sided</code></pre>
<p>In the <code>t.test</code> function, the default behavior is to perform a test with a two-sided alternative and to calculate a 95% confidence interval. Those can be adjusted using the <code>alternative</code> and <code>conf.level</code> arguments. See the help documentation for <code>t.test()</code> function to see how to adust those.</p>
<p>The <code>t.test</code> function can also be used without using a formula by inputing a vector of response variables for the first group and a vector of response variables for the second. The following results in the same model as the formula based interface.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">male_SATs   &lt;-<span class="st"> </span>GPAGender <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>( Gender <span class="op">==</span><span class="st">   &#39;Male&#39;</span> ) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(SAT)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">female_SATs &lt;-<span class="st"> </span>GPAGender <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>( Gender <span class="op">==</span><span class="st"> &#39;Female&#39;</span> ) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(SAT)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">model &lt;-<span class="st"> </span><span class="kw">t.test</span>( male_SATs, female_SATs )</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">broom<span class="op">::</span><span class="kw">tidy</span>(model) <span class="co"># all that information as a data frame</span></a></code></pre></div>
<pre><code>## # A tibble: 1 x 10
##   estimate estimate1 estimate2 statistic p.value parameter conf.low
##      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1     18.6     1214.     1196.      1.41   0.158      323.    -7.27
##   conf.high method                  alternative
##       &lt;dbl&gt; &lt;chr&gt;                   &lt;chr&gt;      
## 1      44.4 Welch Two Sample t-test two.sided</code></pre>
</div>
<div id="paired-t-tests" class="section level4">
<h4><span class="header-section-number">5.2.1.2</span> Paired t-tests</h4>
<p>In a paired t-test, there is some mechanism for pairing observations in the two categories. For example, perhaps we observe the maximum weight lifted by a strongman competitor while wearing a weight belt vs not wearing the belt. Then we look at the difference between the weights lifted for each athlete. In the example we’ll look at here, we have the ages of 100 randomly selected married heterosexual couples from St. Lawerence County, NY. For any given man in the study, the obvious woman to compare his age to is his wife’s. So a paired test makes sense to perform.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&#39;MarriageAges&#39;</span>, <span class="dt">package=</span><span class="st">&#39;Lock5Data&#39;</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw">str</span>(MarriageAges)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    105 obs. of  2 variables:
##  $ Husband: int  53 38 46 30 31 26 29 48 65 29 ...
##  $ Wife   : int  50 34 44 36 23 31 25 51 46 26 ...</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">ggplot</span>(MarriageAges, <span class="kw">aes</span>(<span class="dt">x=</span>Husband, <span class="dt">y=</span>Wife)) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Husband&#39;s Age&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Wife&#39;s Age&quot;</span>)</a></code></pre></div>
<p><img src="05_Model_Building_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>To do a paired t-test, all we need to do is calculate the difference in age for each couple and pass that into the <code>t.test()</code> function.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">MarriageAges &lt;-<span class="st"> </span>MarriageAges <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>( <span class="dt">Age_Diff =</span> Husband <span class="op">-</span><span class="st"> </span>Wife)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="kw">t.test</span>( MarriageAges<span class="op">$</span>Age_Diff)</a></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  MarriageAges$Age_Diff
## t = 5.8025, df = 104, p-value = 7.121e-08
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  1.861895 3.795248
## sample estimates:
## mean of x 
##  2.828571</code></pre>
<p>Alternatively, we could pass the vector of Husband ages and the vector of Wife ages into the <code>t.test()</code> function and tell it that the data is paired so that the first husband is paired with the first wife.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">t.test</span>( MarriageAges<span class="op">$</span>Husband, MarriageAges<span class="op">$</span>Wife, <span class="dt">paired=</span><span class="ot">TRUE</span> )</a></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  MarriageAges$Husband and MarriageAges$Wife
## t = 5.8025, df = 104, p-value = 7.121e-08
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  1.861895 3.795248
## sample estimates:
## mean of the differences 
##                2.828571</code></pre>
<p>Either way that the function is called, the <code>broom::tidy()</code> function could convert the printed output into a nice data frame which can then be used in further analysis.</p>
</div>
</div>
<div id="lm-objects" class="section level3">
<h3><span class="header-section-number">5.2.2</span> lm objects</h3>
<p>The general linear model function <code>lm</code> is more widely used than <code>t.test</code> because <code>lm</code> can be made to perform a t-test and the general linear model allows for fitting more than one explanatory variable and those variables could be either categorical or continuous.</p>
<p>The general workflow will be to:</p>
<ol style="list-style-type: decimal">
<li>Visualize the data</li>
<li>Call <code>lm()</code> using a formula to specify the model to fit.</li>
<li>Save the results of the <code>lm()</code> call to some object (usually I name it <code>model</code>)</li>
<li>Use accessor functions to ask for pertainent quantities that have already been calculated.</li>
<li>Store prediction values and model confidence intervals for each data point in the original data frame.</li>
<li>Graph the original data along with prediction values and model confidence intervals.</li>
</ol>
<p>To explore this topic we’ll use the <code>iris</code> data set to fit a regression model to predict petal length using sepal length.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(<span class="dt">x=</span>Sepal.Length, <span class="dt">y=</span>Petal.Length, <span class="dt">color=</span>Species)) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>() </a></code></pre></div>
<p><img src="05_Model_Building_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Now suppose we want to fit a regression model to these data and allow each species to have its own slope. We would fit the interaction model</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">model &lt;-<span class="st"> </span><span class="kw">lm</span>( Petal.Length <span class="op">~</span><span class="st"> </span>Sepal.Length <span class="op">*</span><span class="st"> </span>Species, <span class="dt">data =</span> iris ) </a></code></pre></div>
</div>
</div>
<div id="accessor-function" class="section level2">
<h2><span class="header-section-number">5.3</span> Accessor function</h2>
<p>Once a model has been fit, we want to obtain a variety of information from the model object. The way that we get most all of this information using base R commands is to call the <code>summary()</code> function which returns a list and then grab whatever we want out of that. Typically for a report, we could just print out all of the summary information and let the reader pick out the information.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">summary</span>(model)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Petal.Length ~ Sepal.Length * Species, data = iris)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.68611 -0.13442 -0.00856  0.15966  0.79607 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                      0.8031     0.5310   1.512    0.133    
## Sepal.Length                     0.1316     0.1058   1.244    0.216    
## Speciesversicolor               -0.6179     0.6837  -0.904    0.368    
## Speciesvirginica                -0.1926     0.6578  -0.293    0.770    
## Sepal.Length:Speciesversicolor   0.5548     0.1281   4.330 2.78e-05 ***
## Sepal.Length:Speciesvirginica    0.6184     0.1210   5.111 1.00e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2611 on 144 degrees of freedom
## Multiple R-squared:  0.9789, Adjusted R-squared:  0.9781 
## F-statistic:  1333 on 5 and 144 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>But if we want to make a nice graph that includes the model’s <span class="math inline">\(R^2\)</span> value on it, we need to code some way of grabbing particular bits of information from the model fit and wrestling into a format that we can easily manipulate it.</p>
<table style="width:100%;">
<colgroup>
<col width="28%" />
<col width="36%" />
<col width="34%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Goal</th>
<th align="left">Base R command</th>
<th align="left"><code>tidymodels</code> version</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Summary table of Coefficients</td>
<td align="left"><code>summary(model)$coef</code></td>
<td align="left"><code>broom::tidy(model)</code></td>
</tr>
<tr class="even">
<td align="center">Parameter Confidence Intervals</td>
<td align="left"><code>confint(model)</code></td>
<td align="left"><code>broom::tidy(model, conf.int=TRUE)</code></td>
</tr>
<tr class="odd">
<td align="center">Rsq and Adj-Rsq</td>
<td align="left"><code>summary(model)$r.squared</code></td>
<td align="left"><code>broom::glance(model)</code></td>
</tr>
<tr class="even">
<td align="center">Model predictions</td>
<td align="left"><code>predict(model)</code></td>
<td align="left"><code>broom::augment(model)</code></td>
</tr>
<tr class="odd">
<td align="center">Model residuals</td>
<td align="left"><code>resid(model)</code></td>
<td align="left"><code>broom::augment(model)</code></td>
</tr>
<tr class="even">
<td align="center">Model predictions w/ CI</td>
<td align="left"><code>predict(model, interval='confidence')</code></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="center">Model predictions w/ PI</td>
<td align="left"><code>predict(model, interval='prediction')</code></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="center">ANOVA table of model fit</td>
<td align="left"><code>anova(model)</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>The package <code>broom</code> has three ways to interact with a model.</p>
<ul>
<li>The <code>tidy</code> command gives a nice table of the model coefficents.</li>
<li>The <code>glance</code> function gives information about how well the model fits the data overall.</li>
<li>The <code>augment</code> function adds the fitted values, residuals, and other diagnostic information to the original data frame used to generate the model.</li>
</ul>
<p>Most of the time, I use the base R commands for accessing information from a model and only resort to the <code>broom</code> commands when I need to access very specific quantities.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">head</span>(iris)</a></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="co"># Remove any previous model prediction values that I&#39;ve added,</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="co"># and then add the model predictions </span></a>
<a class="sourceLine" id="cb22-3" data-line-number="3">iris &lt;-<span class="st"> </span>iris <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>( <span class="op">-</span><span class="kw">matches</span>(<span class="st">&#39;fit&#39;</span>), <span class="op">-</span><span class="kw">matches</span>(<span class="st">&#39;lwr&#39;</span>), <span class="op">-</span><span class="kw">matches</span>(<span class="st">&#39;upr&#39;</span>) ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="st">  </span><span class="kw">cbind</span>( <span class="kw">predict</span>(model, <span class="dt">newdata=</span>., <span class="dt">interval=</span><span class="st">&#39;confidence&#39;</span>) )       </a>
<a class="sourceLine" id="cb22-6" data-line-number="6"></a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="kw">head</span>(iris, <span class="dt">n=</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species      fit
## 1          5.1         3.5          1.4         0.2  setosa 1.474373
## 2          4.9         3.0          1.4         0.2  setosa 1.448047
## 3          4.7         3.2          1.3         0.2  setosa 1.421721
##        lwr      upr
## 1 1.398783 1.549964
## 2 1.371765 1.524329
## 3 1.324643 1.518798</code></pre>
<p>Now that the fitted values that define the regression lines and the associated confidence interval band information has been added to my <code>iris</code> data set, we can now plot the raw data and the regression model predictions.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(<span class="dt">x=</span>Sepal.Length, <span class="dt">y=</span>Petal.Length, <span class="dt">color=</span>Species)) <span class="op">+</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_line</span>( <span class="kw">aes</span>(<span class="dt">y=</span>fit) ) <span class="op">+</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_ribbon</span>( <span class="kw">aes</span>( <span class="dt">ymin=</span>lwr, <span class="dt">ymax=</span>upr), <span class="dt">alpha=</span>.<span class="dv">3</span> )   <span class="co"># alpha is the ribbon transparency</span></a></code></pre></div>
<p><img src="05_Model_Building_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Now to add the R-squared value to the graph, we need to add a simple text layer. To do that, I’ll make a data frame that has the information, and then add the x and y coordinates for where it should go.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">Rsq_data &lt;-<span class="st"> </span>broom<span class="op">::</span><span class="kw">glance</span>(model) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(r.squared) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">r.squared =</span> <span class="kw">round</span>(r.squared, <span class="dt">digits=</span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st">   </span><span class="co"># only 3 digits of precision</span></a>
<a class="sourceLine" id="cb25-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">r.squared =</span> <span class="kw">paste</span>(<span class="st">&#39;Rsq =&#39;</span>, r.squared)) <span class="op">%&gt;%</span><span class="st">    </span><span class="co"># append some text before</span></a>
<a class="sourceLine" id="cb25-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>( <span class="dt">Sepal.Length =</span><span class="dv">7</span>, <span class="dt">Petal.Length=</span><span class="fl">2.5</span>)           <span class="co"># set the location to place it</span></a>
<a class="sourceLine" id="cb25-6" data-line-number="6"></a>
<a class="sourceLine" id="cb25-7" data-line-number="7">Rsq_data</a></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   r.squared   Sepal.Length Petal.Length
##   &lt;chr&gt;              &lt;dbl&gt;        &lt;dbl&gt;
## 1 Rsq = 0.979            7          2.5</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(<span class="dt">x=</span>Sepal.Length, <span class="dt">y=</span>Petal.Length, <span class="dt">color=</span>Species)) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>(  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_line</span>( <span class="kw">aes</span>(<span class="dt">y=</span>fit)  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_ribbon</span>( <span class="kw">aes</span>( <span class="dt">ymin=</span>lwr, <span class="dt">ymax=</span>upr), <span class="dt">alpha=</span>.<span class="dv">3</span> ) <span class="op">+</span><span class="st">   </span><span class="co"># alpha is the ribbon transparency</span></a>
<a class="sourceLine" id="cb27-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_label</span>( <span class="dt">data=</span>Rsq_data, <span class="kw">aes</span>(<span class="dt">label=</span>r.squared, <span class="dt">color=</span><span class="ot">NULL</span>) )</a></code></pre></div>
<p><img src="05_Model_Building_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="exercises-4" class="section level2">
<h2><span class="header-section-number">5.4</span> Exercises</h2>
<ol style="list-style-type: decimal">
<li>Using the <code>trees</code> data frame that comes pre-installed in R, fit the regression model that uses the tree <code>Height</code> to explain the <code>Volume</code> of wood harvested from the tree.
<ol style="list-style-type: lower-alpha">
<li>Graph the data</li>
<li>Fit a <code>lm</code> model using the command <code>model &lt;- lm(Volume ~ Height, data=trees)</code>.</li>
<li>Print out a table with just the regression coefficients, standard error, and upper and lower 95% confidence intervals.</li>
<li>Add the model fitted values to the <code>trees</code> data frame along with the regression model confidence intervals.</li>
<li>Graph the data and model result.</li>
<li>Add the R-squared value as an annotation to the graph.</li>
</ol></li>
<li>The data set <code>phbirths</code> from the <code>faraway</code> package contains information birth weight, gestational length, and smoking status of mother. We’ll fit a quadratic model to predict infant birthweight using the gestational time.
<ol style="list-style-type: lower-alpha">
<li>Create scatterplots of gestational length and birthweight for each smoking status.</li>
<li>Remove all the observations that are premature (less than 36 weeks).</li>
<li>Fit the quadratic model <code>grams ~ poly(gestate,2) * smoke</code>.</li>
<li>Add the model fitted values to the <code>phbirths</code> data frame along with the regression model confidence intervals.</li>
<li>Graph the data and model result.</li>
<li>Create a column for the residuals in the <code>phbirths</code> data set.</li>
<li>Create a histogram of the residuals.</li>
</ol></li>
</ol>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&#39;phbirths&#39;</span>, <span class="dt">package=</span><span class="st">&#39;faraway&#39;</span>)</a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="kw">ggplot</span>(phbirths, <span class="kw">aes</span>(<span class="dt">x=</span>gestate, <span class="dt">y=</span>grams)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>smoke)</a></code></pre></div>
<p><img src="05_Model_Building_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="4-data-wrangling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="6-flow-control.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"],
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/dereksonderegger/444/raw/master/05_Model_Building.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
